{"id":"dogpile-0q0","title":"[Zachodniopomorskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:29.176513709+01:00","updated_at":"2025-12-30T13:21:29.176513709+01:00","dependencies":[{"issue_id":"dogpile-0q0","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:29.193399906+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.1","title":"Scraper: Schronisko w Szczecinie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.217671296+01:00","updated_at":"2025-12-30T13:21:29.217671296+01:00","dependencies":[{"issue_id":"dogpile-0q0.1","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.218025462+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.2","title":"Scraper: Schronisko w Kołobrzegu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.289297091+01:00","updated_at":"2025-12-30T13:21:29.289297091+01:00","dependencies":[{"issue_id":"dogpile-0q0.2","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.289767288+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.3","title":"Scraper: Schronisko w Świnoujściu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.360120624+01:00","updated_at":"2025-12-30T13:21:29.360120624+01:00","dependencies":[{"issue_id":"dogpile-0q0.3","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.360572225+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.4","title":"Scraper: Schronisko w Kiczarowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.431442388+01:00","updated_at":"2025-12-30T13:21:29.431442388+01:00","dependencies":[{"issue_id":"dogpile-0q0.4","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.431776606+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.5","title":"Scraper: Schronisko w Choszcznie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.501730459+01:00","updated_at":"2025-12-30T13:21:29.501730459+01:00","dependencies":[{"issue_id":"dogpile-0q0.5","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.502127507+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.6","title":"Scraper: Schronisko w Golczewie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.576036339+01:00","updated_at":"2025-12-30T13:21:29.576036339+01:00","dependencies":[{"issue_id":"dogpile-0q0.6","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.576390074+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.7","title":"Scraper: Schronisko w Dobrej","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.65300531+01:00","updated_at":"2025-12-30T13:21:29.65300531+01:00","dependencies":[{"issue_id":"dogpile-0q0.7","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.653369766+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.8","title":"Scraper: Stowarzyszenie Trzymaj Się Kocie!","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.724742748+01:00","updated_at":"2025-12-30T13:21:29.724742748+01:00","dependencies":[{"issue_id":"dogpile-0q0.8","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.725103977+01:00","created_by":"daemon"}]}
{"id":"dogpile-0q0.9","title":"Scraper: Koty spod Bloku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.797784323+01:00","updated_at":"2025-12-30T13:21:29.797784323+01:00","dependencies":[{"issue_id":"dogpile-0q0.9","depends_on_id":"dogpile-0q0","type":"parent-child","created_at":"2025-12-30T13:21:29.798124713+01:00","created_by":"daemon"}]}
{"id":"dogpile-25a","title":"Implement semantic search in API","description":"Add semantic search endpoint to API worker.\n\nFlow:\n1. User query -\u003e OpenRouter embed -\u003e vector\n2. Vectorize similarity search -\u003e dog IDs\n3. D1 fetch dog records by IDs\n4. Apply hard filters (city, size, etc)\n5. Return results\n\nEndpoint: GET /search?q=friendly+family+dog\u0026city=warszawa","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-28T20:33:56.882888614+01:00","updated_at":"2025-12-29T00:15:00.604580373+01:00","closed_at":"2025-12-29T00:15:00.604580373+01:00","close_reason":"Implemented API endpoints with CORS for dogs listing, detail, search, and shelters","dependencies":[{"issue_id":"dogpile-25a","depends_on_id":"dogpile-4ds","type":"blocks","created_at":"2025-12-28T20:34:03.494903607+01:00","created_by":"daemon"},{"issue_id":"dogpile-25a","depends_on_id":"dogpile-cv8","type":"blocks","created_at":"2025-12-28T20:43:39.455545855+01:00","created_by":"daemon"}]}
{"id":"dogpile-29l","title":"Embeddings and Vectorize integration","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T13:02:43.269514033+01:00","updated_at":"2025-12-29T17:05:49.485652093+01:00","closed_at":"2025-12-29T17:05:49.485652093+01:00","close_reason":"Embeddings integration complete. OpenRouter/gemini-embedding-001 generates 3072-dim vectors, Vectorize storage via queue/worker architecture."}
{"id":"dogpile-29l.1","title":"Calculate and store embeddings during pipeline","description":"Use OpenRouter gemini-embedding-001 to generate embeddings for dog bio/description. Store in Cloudflare Vectorize during process command.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T13:02:50.333919592+01:00","updated_at":"2025-12-29T17:05:04.948644679+01:00","closed_at":"2025-12-29T17:05:04.948644679+01:00","close_reason":"Embedding generation added to CLI pipeline. Vectorize storage happens via embedder worker queue when deployed. Tested locally: gemini-embedding-001 returns 3072-dim vectors.","dependencies":[{"issue_id":"dogpile-29l.1","depends_on_id":"dogpile-29l","type":"parent-child","created_at":"2025-12-29T13:02:50.345546676+01:00","created_by":"daemon"}]}
{"id":"dogpile-2o2","title":"Build first real shelter adapter","description":"Create the first production shelter adapter as a template for others.\n\nPick a shelter with:\n- Stable URLs or external IDs\n- Reasonable HTML structure\n- Good variety of dog data\n\nAdapter must:\n- Compute fingerprint from stable source data (URL or ID)\n- Extract rawDescription for AI processing\n- Return RawDogData with all available fields\n\nThis will serve as the reference implementation for other adapters.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-28T20:32:35.255007444+01:00","updated_at":"2025-12-28T21:18:42.901852371+01:00","closed_at":"2025-12-28T21:18:42.901852371+01:00","close_reason":"Implemented TOZ Jawor adapter with JSON API integration"}
{"id":"dogpile-3ci","title":"[Lubelskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:30.912521266+01:00","updated_at":"2025-12-30T13:21:30.912521266+01:00","dependencies":[{"issue_id":"dogpile-3ci","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:30.92758763+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ci.1","title":"Scraper: Schronisko w Lublinie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.94385786+01:00","updated_at":"2025-12-30T13:21:30.94385786+01:00","dependencies":[{"issue_id":"dogpile-3ci.1","depends_on_id":"dogpile-3ci","type":"parent-child","created_at":"2025-12-30T13:21:30.944116404+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ci.2","title":"Scraper: Schronisko w Nowodworze","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.012697939+01:00","updated_at":"2025-12-30T13:21:31.012697939+01:00","dependencies":[{"issue_id":"dogpile-3ci.2","depends_on_id":"dogpile-3ci","type":"parent-child","created_at":"2025-12-30T13:21:31.012990998+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ci.3","title":"Scraper: Schronisko w Puławach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.080853951+01:00","updated_at":"2025-12-30T13:21:31.080853951+01:00","dependencies":[{"issue_id":"dogpile-3ci.3","depends_on_id":"dogpile-3ci","type":"parent-child","created_at":"2025-12-30T13:21:31.081182047+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ci.4","title":"Scraper: Schronisko w Zamościu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.153387538+01:00","updated_at":"2025-12-30T13:21:31.153387538+01:00","dependencies":[{"issue_id":"dogpile-3ci.4","depends_on_id":"dogpile-3ci","type":"parent-child","created_at":"2025-12-30T13:21:31.153679385+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ci.5","title":"Scraper: Schronisko w Chełmie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.225175522+01:00","updated_at":"2025-12-30T13:21:31.225175522+01:00","dependencies":[{"issue_id":"dogpile-3ci.5","depends_on_id":"dogpile-3ci","type":"parent-child","created_at":"2025-12-30T13:21:31.225460726+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ci.6","title":"Scraper: Schronisko w Krzesimowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.294750623+01:00","updated_at":"2025-12-30T13:21:31.294750623+01:00","dependencies":[{"issue_id":"dogpile-3ci.6","depends_on_id":"dogpile-3ci","type":"parent-child","created_at":"2025-12-30T13:21:31.295036529+01:00","created_by":"daemon"}]}
{"id":"dogpile-3ul","title":"Implement PhotoStore for R2","description":"Implement PhotoStore interface for dual R2 bucket storage.\n\nBuckets:\n- dogpile-photos-original: scraped shelter photos\n- dogpile-photos-generated: AI-generated images\n\nKey format: {dog_id}/{index}.jpg\n\nInterface in packages/core/src/services/image-store.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T20:33:23.319091592+01:00","updated_at":"2025-12-29T00:11:05.406799898+01:00","closed_at":"2025-12-29T00:11:05.406799898+01:00","close_reason":"Implemented PhotoStoreLive for R2 bucket operations"}
{"id":"dogpile-47n","title":"Generate D1 migrations","description":"Run drizzle-kit generate to create SQL migrations from schema.\n\nThen apply to D1:\n- Local: wrangler d1 execute dogpile-db --local --file migrations/0001_*.sql\n- Remote: wrangler d1 execute dogpile-db --remote --file migrations/0001_*.sql","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T20:33:41.101118975+01:00","updated_at":"2025-12-29T00:11:42.076014468+01:00","closed_at":"2025-12-29T00:11:42.076014468+01:00","close_reason":"Generated D1 migration with all tables and indexes"}
{"id":"dogpile-4ds","title":"Implement EmbeddingService with OpenRouter","description":"Implement EmbeddingService interface using OpenRouter embeddings API.\n\nUse gemini-embedding-001 model for Polish language support.\n\nInterface in packages/core/src/services/embedding.ts:\n- embed(text) -\u003e vector\n- embedBatch(texts) -\u003e vectors\n\nAdd retry logic for API failures.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T20:33:15.162389594+01:00","updated_at":"2025-12-28T20:41:20.089709325+01:00","closed_at":"2025-12-28T20:41:20.089709325+01:00","close_reason":"Superseded by more detailed OpenRouter tasks"}
{"id":"dogpile-4eb","title":"[Dolnośląskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:31.760976262+01:00","updated_at":"2025-12-30T13:21:31.760976262+01:00","dependencies":[{"issue_id":"dogpile-4eb","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:31.7772237+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.1","title":"Scraper: Schronisko we Wrocławiu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.794159421+01:00","updated_at":"2025-12-30T13:21:31.794159421+01:00","dependencies":[{"issue_id":"dogpile-4eb.1","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:31.794460014+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.10","title":"Scraper: Dom Tymczasowy Łatka na Łapce","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.415747944+01:00","updated_at":"2025-12-30T13:21:32.415747944+01:00","dependencies":[{"issue_id":"dogpile-4eb.10","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.41601287+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.11","title":"Scraper: Fundacja Kubusia Puchatka","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.484452082+01:00","updated_at":"2025-12-30T13:21:32.484452082+01:00","dependencies":[{"issue_id":"dogpile-4eb.11","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.484721867+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.12","title":"Scraper: Stowarzyszenie Zwierzaki Bezdomniaki","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.55295613+01:00","updated_at":"2025-12-30T13:21:32.55295613+01:00","dependencies":[{"issue_id":"dogpile-4eb.12","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.553225093+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.2","title":"Scraper: Schronisko w Wałbrzychu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.863260958+01:00","updated_at":"2025-12-30T13:21:31.863260958+01:00","dependencies":[{"issue_id":"dogpile-4eb.2","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:31.86356036+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.3","title":"Scraper: Schronisko w Jeleniej Górze","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.931403455+01:00","updated_at":"2025-12-30T13:21:31.931403455+01:00","dependencies":[{"issue_id":"dogpile-4eb.3","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:31.931696574+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.4","title":"Scraper: Schronisko w Dzierżoniowie Azyl","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.000940102+01:00","updated_at":"2025-12-30T13:21:32.000940102+01:00","dependencies":[{"issue_id":"dogpile-4eb.4","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.001212773+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.5","title":"Scraper: Schronisko w Dłużynie Górnej","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.070515984+01:00","updated_at":"2025-12-30T13:21:32.070515984+01:00","dependencies":[{"issue_id":"dogpile-4eb.5","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.070830254+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.6","title":"Scraper: Schronisko w Legnicy","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.140185937+01:00","updated_at":"2025-12-30T13:33:42.191600821+01:00","closed_at":"2025-12-30T13:33:42.191600821+01:00","close_reason":"Implemented lpgk-legnica adapter with pagination support and per-dog page fetching","dependencies":[{"issue_id":"dogpile-4eb.6","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.14047575+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.7","title":"Scraper: Schronisko w Świdnicy","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.208507745+01:00","updated_at":"2025-12-30T13:21:32.208507745+01:00","dependencies":[{"issue_id":"dogpile-4eb.7","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.208930061+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.8","title":"Scraper: Fundacja Tara Schronisko dla Koni","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.27818959+01:00","updated_at":"2025-12-30T13:21:32.27818959+01:00","dependencies":[{"issue_id":"dogpile-4eb.8","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.278466389+01:00","created_by":"daemon"}]}
{"id":"dogpile-4eb.9","title":"Scraper: Fundacja Centaurus Folwark","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.347146782+01:00","updated_at":"2025-12-30T13:21:32.347146782+01:00","dependencies":[{"issue_id":"dogpile-4eb.9","depends_on_id":"dogpile-4eb","type":"parent-child","created_at":"2025-12-30T13:21:32.347457855+01:00","created_by":"daemon"}]}
{"id":"dogpile-4jr","title":"Implement AIExtractionService with OpenRouter/Gemini","description":"Implement the AIExtractionService interface using OpenRouter API with gemini-embedding-001 model.\n\nTwo extraction passes:\n1. Text extraction: name, sex, age, breed, size, weight, personality, health, compatibility, location\n2. Photo extraction: breed confirmation, fur, color, ears, tail, size/age refinement\n\nMust handle nullable fields gracefully - shelters have inconsistent data.\n\nOutput should match TextExtractionResult and PhotoExtractionResult interfaces in packages/core/src/services/ai-extraction.ts","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-28T20:32:15.61846583+01:00","updated_at":"2025-12-28T20:41:10.567857653+01:00","closed_at":"2025-12-28T20:41:10.567857653+01:00","close_reason":"Superseded by more detailed OpenRouter tasks"}
{"id":"dogpile-7we","title":"Implement DescriptionGenerator service","description":"Create DescriptionGenerator Effect service for generating consistent, warm dog bios.\n\n## Purpose\nGenerate a consistent 'Dogpile style' description for every dog instead of showing raw shelter text.\nThis ensures uniform tone across all listings regardless of shelter writing quality.\n\n## Depends on\n- OpenRouterClient (dogpile-czv)\n- JSON Schemas (dogpile-ogp)\n- AI Config (dogpile-u1d)\n\n## Interface\n```typescript\ninterface DescriptionGenerator {\n  generate: (dogData: DogData) =\u003e Effect\u003cGeneratedBio, GenerationError\u003e\n}\n\ninterface DogData {\n  name: string\n  breedEstimates: BreedEstimate[]\n  ageEstimate: AgeEstimate | null\n  sizeEstimate: SizeEstimate | null\n  personalityTags: string[]\n  healthInfo: { vaccinated, sterilized, chipped }\n  compatibility: { kids, dogs, cats }\n  locationCity: string | null\n  isFoster: boolean\n  urgent: boolean\n}\n```\n\n## Style Guide (from design system)\n- Tone: hopeful, warm, empathetic\n- Voice: active, present tense\n- DO: Focus on personality, future with family, unique quirks\n- DON'T: Bureaucratic language, sad backstory focus, 'Subject is...'\n- Length: 2-3 short paragraphs\n- Language: Polish\n\n## System Prompt Structure\n1. You are writing for Dogpile, a dog adoption platform\n2. Style guide rules\n3. Example good/bad descriptions\n4. Input format explanation\n\n## Implementation\n1. Use OpenRouterClient.responses() with MODEL_DESCRIPTION_GEN\n2. Feed structured DogData (NOT raw shelter text) to avoid hallucination\n3. response_format: { type: 'json_schema', json_schema: DogBioSchema }\n4. Validate output\n\nLocation: packages/core/src/services/ai/description-generator.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:42:55.222898808+01:00","updated_at":"2025-12-28T21:07:22.998085091+01:00","closed_at":"2025-12-28T21:07:22.998085091+01:00","close_reason":"Implemented DescriptionGenerator for dog bios","dependencies":[{"issue_id":"dogpile-7we","depends_on_id":"dogpile-czv","type":"blocks","created_at":"2025-12-28T20:43:21.970476559+01:00","created_by":"daemon"},{"issue_id":"dogpile-7we","depends_on_id":"dogpile-u1d","type":"blocks","created_at":"2025-12-28T20:43:21.985301239+01:00","created_by":"daemon"},{"issue_id":"dogpile-7we","depends_on_id":"dogpile-ogp","type":"blocks","created_at":"2025-12-28T20:43:22.000232473+01:00","created_by":"daemon"},{"issue_id":"dogpile-7we","depends_on_id":"dogpile-ada","type":"blocks","created_at":"2025-12-28T20:51:25.214484121+01:00","created_by":"daemon"}]}
{"id":"dogpile-9oj","title":"[Infrastructure] Image Optimization Pipeline","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-31T02:05:43.664721363+01:00","updated_at":"2025-12-31T02:37:10.794224012+01:00","closed_at":"2025-12-31T02:37:10.794224012+01:00","close_reason":"Image optimization pipeline complete: design doc, image queue, WebP resize, AI photo optimization, responsive frontend","comments":[{"id":7,"issue_id":"dogpile-9oj","author":"ribelo","text":"## Problem\nImages from shelter websites and AI-generated photos are unoptimized:\n- Original shelter photos are often 2000x3000px, 2-5MB each\n- AI-generated photos from nanobanana are high-res base64, heavy to load\n- No resizing, no WebP conversion, no thumbnails\n- Results in slow page loads, especially on mobile\n\n## Current Architecture\n- Scraped photos: stored as URLs pointing to shelter websites (not cached)\n- Generated photos: stored as URLs to R2 bucket (dogpile-photos-generated)\n- R2 buckets mentioned in AGENTS.md: dogpile-photos-original, dogpile-photos-generated\n\n## Target Architecture\n\n### R2 Bucket Structure\n```\ndogpile-photos-original/\n  {dogId}/\n    original-1.jpg      # Full resolution backup\n    original-2.jpg\n\ndogpile-photos-optimized/\n  {dogId}/\n    thumb-1.webp        # 200x250 for grid cards\n    medium-1.webp       # 400x500 for grid hover\n    large-1.webp        # 800x1000 for detail page\n    thumb-2.webp\n    ...\n\ndogpile-photos-generated/\n  {dogId}/\n    professional.webp   # AI-generated, optimized\n    fun-nose.webp\n```\n\n### Image Sizes\n| Name | Size | Use Case |\n|------|------|----------|\n| thumb | 200x250 | DogCard grid (lazy loaded) |\n| medium | 400x500 | DogCard hover/focus |\n| large | 800x1000 | Dog detail page |\n| original | varies | Backup, future use |\n\n### Processing Pipeline\n1. Scraper fetches dog with photo URLs\n2. Photo processor worker:\n   a. Download original from shelter URL\n   b. Store in R2 dogpile-photos-original/\n   c. Resize to thumb/medium/large\n   d. Convert to WebP (quality 80)\n   e. Store in R2 dogpile-photos-optimized/\n   f. Update DB with new URLs\n\n3. For AI-generated photos:\n   a. Receive base64 from nanobanana\n   b. Decode and store original in R2\n   c. Resize to WebP variants\n   d. Update DB with optimized URLs\n\n## Dependencies\n- Cloudflare Images OR custom resizer with sharp (Bun)\n- May need separate worker for image processing (CPU intensive)\n\n## Success Metrics\n- DogCard images \u003c 30KB each\n- Detail page images \u003c 100KB each  \n- Lighthouse performance score \u003e 90\n- Time to first dog visible \u003c 2s","created_at":"2025-12-31T01:06:03Z"}]}
{"id":"dogpile-9oj.1","title":"Design image processing strategy","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T02:06:09.141028326+01:00","updated_at":"2025-12-31T02:21:10.78130594+01:00","closed_at":"2025-12-31T02:21:10.78130594+01:00","close_reason":"Design documented in docs/image-optimization-design.md","dependencies":[{"issue_id":"dogpile-9oj.1","depends_on_id":"dogpile-9oj","type":"parent-child","created_at":"2025-12-31T02:06:09.151980808+01:00","created_by":"daemon"}],"comments":[{"id":8,"issue_id":"dogpile-9oj.1","author":"ribelo","text":"## Objective\nDecide on the technical approach for image resizing and optimization.\n\n## Options to Evaluate\n\n### Option A: Cloudflare Images\n- Pros: Managed service, automatic resizing via URL params, CDN integrated\n- Cons: Additional cost ($5/100K images), vendor lock-in\n- Implementation: Enable Cloudflare Images, use transform URLs\n\n### Option B: Cloudflare Workers with photon (WASM)\n- Pros: Free tier, runs on edge, no external deps\n- Cons: CPU limits (50ms), may timeout on large images\n- Implementation: WASM image library in worker\n\n### Option C: Separate Bun worker with sharp\n- Pros: Full control, best quality, no limits\n- Cons: Need separate hosting (not CF Workers), more infra\n- Implementation: Bun service with sharp, triggered via queue\n\n### Option D: R2 + Image Resizing at Build/Scrape Time\n- Pros: One-time cost, images pre-optimized\n- Cons: Increases scrape time, storage costs\n- Implementation: Process images in scraper-processor before DB insert\n\n## Recommendation\nStart with Option D (resize during scraping) because:\n1. No additional infrastructure needed\n2. Images are processed once, served many times\n3. Can use Bun + sharp in scraper-processor (already Bun-based)\n4. CF Workers can't use sharp, but scraper runs as queue consumer\n\n## Decision Needed\n- Confirm approach\n- Define exact image sizes and quality settings\n- Estimate storage costs (R2 pricing)\n\n## Research Required\n1. Check if scraper-processor runs on Bun or CF Workers\n2. Test sharp in Cloudflare Workers (may work with WASM)\n3. Calculate R2 storage for ~10K dogs x 5 photos x 3 sizes\n\n## Output\nDocument decision in this issue, then create implementation tasks","created_at":"2025-12-31T01:06:26Z"}]}
{"id":"dogpile-9oj.2","title":"Download and cache scraped photos to R2","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T02:06:31.863929265+01:00","updated_at":"2025-12-31T02:26:25.786401894+01:00","closed_at":"2025-12-31T02:26:25.786401894+01:00","close_reason":"Implemented image queue in scraper-processor with download and R2 caching","dependencies":[{"issue_id":"dogpile-9oj.2","depends_on_id":"dogpile-9oj","type":"parent-child","created_at":"2025-12-31T02:06:31.871256542+01:00","created_by":"daemon"},{"issue_id":"dogpile-9oj.2","depends_on_id":"dogpile-9oj.1","type":"blocked-by","created_at":"2025-12-31T02:08:24.606059941+01:00","created_by":"daemon"}],"comments":[{"id":9,"issue_id":"dogpile-9oj.2","author":"ribelo","text":"## Problem\nCurrently, scraped photos are stored as URLs to shelter websites:\n- Shelter can change/delete images anytime\n- No control over image size or format\n- Slow to load from various origins\n\n## Solution\nDownload photos during scraping and store in R2.\n\n## Implementation\n\n### 1. Update scraper-processor/src/index.ts\n\nAfter parsing dog data, before inserting to DB:\n\n```typescript\n// Add photo processing step\nconst processPhotos = (photos: string[], dogId: string) =\u003e\n  Effect.gen(function* () {\n    const imageStore = yield* ImageStore\n    const processedUrls: string[] = []\n    \n    for (const [i, url] of photos.entries()) {\n      // Download original\n      const response = yield* Effect.tryPromise(() =\u003e fetch(url))\n      const buffer = yield* Effect.tryPromise(() =\u003e response.arrayBuffer())\n      \n      // Store original in R2\n      const key = `originals/${dogId}/photo-${i}.jpg`\n      const storedUrl = yield* imageStore.upload(key, buffer, 'image/jpeg')\n      \n      processedUrls.push(storedUrl)\n    }\n    \n    return processedUrls\n  })\n```\n\n### 2. Update wrangler.toml\n\nEnsure R2 bucket binding exists:\n```toml\n[[r2_buckets]]\nbinding = \"PHOTOS_ORIGINAL\"\nbucket_name = \"dogpile-photos-original\"\n```\n\n### 3. Update DB schema (if needed)\n\nCurrent schema stores photos as string[]. This is fine - just store R2 URLs instead of shelter URLs.\n\n### 4. Error Handling\n\n- If photo download fails, log warning and skip (don't fail entire dog)\n- Retry with exponential backoff (shelter may rate limit)\n- Set timeout (10s per photo)\n\n## Files to Modify\n- apps/scraper-processor/src/index.ts\n- apps/scraper-processor/wrangler.toml\n- packages/core/src/services/photo-store.ts (if needed)\n\n## Testing\n1. Run scraper for one shelter\n2. Verify photos appear in R2 bucket\n3. Verify DB contains R2 URLs\n4. Verify images load from R2 in browser\n\n## Depends On\n- dogpile-9oj.1 (design decision)","created_at":"2025-12-31T01:06:51Z"}]}
{"id":"dogpile-9oj.3","title":"Resize photos to multiple sizes during processing","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T02:06:57.20748228+01:00","updated_at":"2025-12-31T02:26:25.811927818+01:00","closed_at":"2025-12-31T02:26:25.811927818+01:00","close_reason":"Implemented sm/lg WebP resizing using Cloudflare Images binding","dependencies":[{"issue_id":"dogpile-9oj.3","depends_on_id":"dogpile-9oj","type":"parent-child","created_at":"2025-12-31T02:06:57.219371465+01:00","created_by":"daemon"},{"issue_id":"dogpile-9oj.3","depends_on_id":"dogpile-9oj.2","type":"blocked-by","created_at":"2025-12-31T02:08:24.626274221+01:00","created_by":"daemon"}],"comments":[{"id":10,"issue_id":"dogpile-9oj.3","author":"ribelo","text":"## Problem\nOriginal photos are too large for web display. Need optimized sizes.\n\n## Solution\nResize photos to thumb/medium/large during processing, convert to WebP.\n\n## Image Sizes\n\n| Name | Dimensions | Quality | Target Size | Use Case |\n|------|------------|---------|-------------|----------|\n| thumb | 200x250 | 75 | \u003c20KB | Grid cards |\n| medium | 400x500 | 80 | \u003c50KB | Card hover |\n| large | 800x1000 | 85 | \u003c100KB | Detail page |\n| original | as-is | 100 | varies | Backup |\n\nAll sizes maintain 4:5 aspect ratio with cover fit.\n\n## Implementation\n\n### 1. Create image-resizer service\n\npackages/core/src/services/image-resizer.ts:\n```typescript\nimport sharp from 'sharp'\nimport { Effect, Context, Layer } from 'effect'\n\ninterface ImageSize {\n  name: string\n  width: number\n  height: number\n  quality: number\n}\n\nconst SIZES: ImageSize[] = [\n  { name: 'thumb', width: 200, height: 250, quality: 75 },\n  { name: 'medium', width: 400, height: 500, quality: 80 },\n  { name: 'large', width: 800, height: 1000, quality: 85 },\n]\n\nexport interface ImageResizer {\n  readonly resize: (\n    input: ArrayBuffer,\n    dogId: string,\n    photoIndex: number\n  ) =\u003e Effect.Effect\u003cResizedImages, Error\u003e\n}\n\nexport interface ResizedImages {\n  thumb: { buffer: ArrayBuffer; key: string }\n  medium: { buffer: ArrayBuffer; key: string }\n  large: { buffer: ArrayBuffer; key: string }\n}\n\nexport const ImageResizer = Context.GenericTag\u003cImageResizer\u003e('@dogpile/ImageResizer')\n\nexport const ImageResizerLive = Layer.succeed(ImageResizer, {\n  resize: (input, dogId, photoIndex) =\u003e\n    Effect.gen(function* () {\n      const results: Record\u003cstring, { buffer: ArrayBuffer; key: string }\u003e = {}\n      \n      for (const size of SIZES) {\n        const resized = yield* Effect.tryPromise(() =\u003e\n          sharp(Buffer.from(input))\n            .resize(size.width, size.height, { fit: 'cover' })\n            .webp({ quality: size.quality })\n            .toBuffer()\n        )\n        \n        results[size.name] = {\n          buffer: resized.buffer,\n          key: `optimized/${dogId}/${size.name}-${photoIndex}.webp`\n        }\n      }\n      \n      return results as ResizedImages\n    })\n})\n```\n\n### 2. Integrate in scraper-processor\n\nAfter downloading original, resize and upload all sizes:\n```typescript\nconst resized = yield* imageResizer.resize(originalBuffer, dogId, i)\n\n// Upload all sizes\nconst thumbUrl = yield* imageStore.upload(resized.thumb.key, resized.thumb.buffer, 'image/webp')\nconst mediumUrl = yield* imageStore.upload(resized.medium.key, resized.medium.buffer, 'image/webp')\nconst largeUrl = yield* imageStore.upload(resized.large.key, resized.large.buffer, 'image/webp')\n```\n\n### 3. Update DB schema\n\nAdd new columns for different sizes:\n```typescript\n// packages/db/src/schema.ts\nphotosThumbnail: text('photos_thumbnail', { mode: 'json' }).\u003cstring[]\u003e(),\nphotosMedium: text('photos_medium', { mode: 'json' }).\u003cstring[]\u003e(),\nphotosLarge: text('photos_large', { mode: 'json' }).\u003cstring[]\u003e(),\n// Keep existing 'photos' for originals\n```\n\n## Files to Modify\n- packages/core/src/services/image-resizer.ts (new)\n- packages/core/src/services/index.ts (export)\n- apps/scraper-processor/src/index.ts\n- packages/db/src/schema.ts\n- apps/api/src/index.ts (return appropriate size)\n\n## Depends On\n- dogpile-9oj.1 (design decision)\n- dogpile-9oj.2 (download photos first)\n\n## Testing\n1. Process one dog with photos\n2. Verify all 3 sizes exist in R2\n3. Compare file sizes (should be much smaller)\n4. Verify images display correctly at each size","created_at":"2025-12-31T01:07:23Z"}]}
{"id":"dogpile-9oj.4","title":"Optimize AI-generated photos","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T02:07:29.295629058+01:00","updated_at":"2025-12-31T02:30:58.897837671+01:00","closed_at":"2025-12-31T02:30:58.897837671+01:00","close_reason":"CLI now optimizes AI-generated photos to WebP (sm/lg sizes) before R2 upload","dependencies":[{"issue_id":"dogpile-9oj.4","depends_on_id":"dogpile-9oj","type":"parent-child","created_at":"2025-12-31T02:07:29.302332688+01:00","created_by":"daemon"},{"issue_id":"dogpile-9oj.4","depends_on_id":"dogpile-9oj.3","type":"blocked-by","created_at":"2025-12-31T02:08:24.641670913+01:00","created_by":"daemon"}],"comments":[{"id":11,"issue_id":"dogpile-9oj.4","author":"ribelo","text":"## Problem\nAI-generated photos from nanobanana (OpenRouter image model) are returned as base64 and stored unoptimized.\n\nCurrent flow:\n1. image-generator.ts requests image from OpenRouter\n2. Receives base64 data URL\n3. Stored directly in DB/R2 as-is\n4. Large file sizes, slow to load\n\n## Current Code\n\npackages/core/src/services/image-generator.ts:\n```typescript\ninterface GeneratedPhoto {\n  readonly base64Url: string  // Full data:image/png;base64,... URL\n}\n```\n\n## Solution\nDecode base64, resize to optimized sizes, convert to WebP.\n\n## Implementation\n\n### 1. Update image-generator.ts\n\n```typescript\n// After receiving base64 from OpenRouter:\nconst base64Data = result.choices[0].message.content\n  .find(c =\u003e c.type === 'image_url')?.image_url?.url\n\nif (base64Data) {\n  // Decode base64\n  const base64 = base64Data.replace(/^data:image\\/\\w+;base64,/, '')\n  const buffer = Buffer.from(base64, 'base64')\n  \n  // Resize using ImageResizer service\n  const imageResizer = yield* ImageResizer\n  const resized = yield* imageResizer.resize(buffer, dogId, 'generated-professional')\n  \n  // Upload optimized version\n  const imageStore = yield* ImageStore\n  const url = yield* imageStore.upload(\n    resized.large.key, \n    resized.large.buffer, \n    'image/webp'\n  )\n  \n  return { url } // Return R2 URL instead of base64\n}\n```\n\n### 2. Update GeneratedPhoto interface\n\n```typescript\ninterface GeneratedPhoto {\n  readonly url: string           // R2 URL\n  readonly thumbnailUrl?: string // Optional thumb for previews\n}\n```\n\n### 3. Update embedder or wherever generated photos are stored\n\nEnsure photosGenerated column stores R2 URLs, not base64.\n\n## Files to Modify\n- packages/core/src/services/image-generator.ts\n- apps/embedder/src/index.ts (if it handles photo storage)\n- apps/scraper-processor/src/index.ts (if it generates photos)\n\n## Testing\n1. Trigger AI photo generation for a dog\n2. Verify R2 contains optimized WebP\n3. Verify DB stores R2 URL (not base64)\n4. Verify image loads quickly on frontend\n\n## Depends On\n- dogpile-9oj.3 (image resizer service)","created_at":"2025-12-31T01:07:49Z"}]}
{"id":"dogpile-9oj.5","title":"Update frontend to use optimized image URLs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T02:07:55.83678818+01:00","updated_at":"2025-12-31T02:36:57.596563604+01:00","closed_at":"2025-12-31T02:36:57.596563604+01:00","close_reason":"Frontend updated with photo-url utility, responsive srcset, and OG image support","dependencies":[{"issue_id":"dogpile-9oj.5","depends_on_id":"dogpile-9oj","type":"parent-child","created_at":"2025-12-31T02:07:55.881405867+01:00","created_by":"daemon"},{"issue_id":"dogpile-9oj.5","depends_on_id":"dogpile-9oj.3","type":"blocked-by","created_at":"2025-12-31T02:08:24.657174778+01:00","created_by":"daemon"}],"comments":[{"id":12,"issue_id":"dogpile-9oj.5","author":"ribelo","text":"## Problem\nFrontend currently uses single 'photos' array. Need to use appropriate size per context.\n\n## Solution\nUpdate API to return multiple sizes, update frontend components to use correct size.\n\n## Implementation\n\n### 1. Update API response\n\napps/api/src/index.ts - modify dog response:\n```typescript\nreturn {\n  ...dog,\n  photos: {\n    thumbnails: dog.photosThumbnail || [],\n    medium: dog.photosMedium || [],\n    large: dog.photosLarge || [],\n    original: dog.photos || [],\n  },\n  photosGenerated: {\n    thumbnails: dog.photosGeneratedThumbnail || [],\n    large: dog.photosGeneratedLarge || [],\n  }\n}\n```\n\n### 2. Update DogCard.tsx\n\nUse thumbnail for grid display:\n```tsx\n\u003cImageSlider \n  photos={dog.photos.thumbnails} \n  photosGenerated={dog.photosGenerated.thumbnails}\n  // ... \n/\u003e\n```\n\n### 3. Update dogs/[id].astro\n\nUse large size for detail page:\n```tsx\n\u003cImageSlider \n  photos={dog.photos.large} \n  photosGenerated={dog.photosGenerated.large}\n  autoPlay={true}\n/\u003e\n```\n\n### 4. Update ImageSlider.tsx\n\nAdd srcset support for responsive images:\n```tsx\ninterface Props {\n  photos: string[]\n  photosMedium?: string[]  // For hover/larger display\n  photosGenerated: string[]\n  // ...\n}\n\n// Use medium on hover if available\nconst getPhotoUrl = (index: number, isHover: boolean) =\u003e {\n  if (isHover \u0026\u0026 props.photosMedium?.[index]) {\n    return props.photosMedium[index]\n  }\n  return allPhotos()[index]\n}\n```\n\n### 5. Update types\n\npackages/web/src/components/types.ts:\n```typescript\ninterface Dog {\n  photos: {\n    thumbnails: string[]\n    medium: string[]\n    large: string[]\n    original: string[]\n  }\n  photosGenerated: {\n    thumbnails: string[]\n    large: string[]\n  }\n  // ... other fields\n}\n```\n\n## Files to Modify\n- apps/api/src/index.ts\n- apps/web/src/components/types.ts\n- apps/web/src/components/DogCard.tsx\n- apps/web/src/components/DogGrid.tsx\n- apps/web/src/components/ImageSlider.tsx\n- apps/web/src/pages/dogs/[id].astro\n\n## Backwards Compatibility\nKeep supporting old format (string[]) during transition:\n```typescript\nconst thumbnails = Array.isArray(dog.photos) \n  ? dog.photos  // Old format\n  : dog.photos.thumbnails  // New format\n```\n\n## Testing\n1. Verify DogCard loads thumbnail images\n2. Verify dog detail page loads large images\n3. Check Network tab - confirm small file sizes\n4. Test with old data (before migration)","created_at":"2025-12-31T01:08:17Z"}]}
{"id":"dogpile-9tw","title":"[Warmińsko-Mazurskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:32.624020483+01:00","updated_at":"2025-12-30T13:21:32.624020483+01:00","dependencies":[{"issue_id":"dogpile-9tw","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:32.64138389+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.1","title":"Scraper: Schronisko w Olsztynie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.662367987+01:00","updated_at":"2025-12-30T13:21:32.662367987+01:00","dependencies":[{"issue_id":"dogpile-9tw.1","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:32.662692296+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.2","title":"Scraper: Schronisko w Pudwągach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.732752292+01:00","updated_at":"2025-12-30T13:21:32.732752292+01:00","dependencies":[{"issue_id":"dogpile-9tw.2","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:32.733072664+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.3","title":"Scraper: Schronisko w Zbożnem","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.802797671+01:00","updated_at":"2025-12-30T13:21:32.802797671+01:00","dependencies":[{"issue_id":"dogpile-9tw.3","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:32.803124695+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.4","title":"Scraper: Schronisko w Szczytnie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.873794856+01:00","updated_at":"2025-12-30T13:21:32.873794856+01:00","dependencies":[{"issue_id":"dogpile-9tw.4","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:32.874177205+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.5","title":"Scraper: Schronisko w Bagienicach Małych","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:32.943308479+01:00","updated_at":"2025-12-30T13:21:32.943308479+01:00","dependencies":[{"issue_id":"dogpile-9tw.5","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:32.943676101+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.6","title":"Scraper: Ośrodek Rehabilitacji Ptaków Drapieżnych","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.012647259+01:00","updated_at":"2025-12-30T13:21:33.012647259+01:00","dependencies":[{"issue_id":"dogpile-9tw.6","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:33.012959374+01:00","created_by":"daemon"}]}
{"id":"dogpile-9tw.7","title":"Scraper: Fundacja Albatros","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.082276714+01:00","updated_at":"2025-12-30T13:21:33.082276714+01:00","dependencies":[{"issue_id":"dogpile-9tw.7","depends_on_id":"dogpile-9tw","type":"parent-child","created_at":"2025-12-30T13:21:33.082573901+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt","title":"[Mazowieckie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:23.107889019+01:00","updated_at":"2025-12-30T13:21:23.107889019+01:00","dependencies":[{"issue_id":"dogpile-9yt","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:23.122895398+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.1","title":"Scraper: Schronisko na Paluchu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.138601212+01:00","updated_at":"2025-12-30T13:21:23.138601212+01:00","dependencies":[{"issue_id":"dogpile-9yt.1","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.138884753+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.10","title":"Scraper: Schronisko w Płocku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.75790522+01:00","updated_at":"2025-12-30T13:21:23.75790522+01:00","dependencies":[{"issue_id":"dogpile-9yt.10","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.758292499+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.11","title":"Scraper: Stowarzyszenie Płock Przyjazny Psom","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.82648947+01:00","updated_at":"2025-12-30T13:21:23.82648947+01:00","dependencies":[{"issue_id":"dogpile-9yt.11","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.826789522+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.12","title":"Scraper: Stowarzyszenie Pomiechowskie Bezdomniaki","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.893453136+01:00","updated_at":"2025-12-30T13:21:23.893453136+01:00","dependencies":[{"issue_id":"dogpile-9yt.12","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.893711559+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.13","title":"Scraper: Schronisko Bąkówka","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.961897148+01:00","updated_at":"2025-12-30T13:21:23.961897148+01:00","dependencies":[{"issue_id":"dogpile-9yt.13","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.962231376+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.14","title":"Scraper: Schronisko w Pawłowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.030975691+01:00","updated_at":"2025-12-30T13:21:24.030975691+01:00","dependencies":[{"issue_id":"dogpile-9yt.14","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.031299639+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.15","title":"Scraper: Schronisko w Radomiu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.099599486+01:00","updated_at":"2025-12-30T13:21:24.099599486+01:00","dependencies":[{"issue_id":"dogpile-9yt.15","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.099925568+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.16","title":"Scraper: Schronisko w Żyrardowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.17200085+01:00","updated_at":"2025-12-30T13:21:24.17200085+01:00","dependencies":[{"issue_id":"dogpile-9yt.16","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.172395353+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.17","title":"Scraper: Fundacja Zwierząt Skrzywdzonych Zielony Pies","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.240158044+01:00","updated_at":"2025-12-30T13:21:24.240158044+01:00","dependencies":[{"issue_id":"dogpile-9yt.17","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.240473246+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.18","title":"Scraper: Stowarzyszenie Bezdomne Serduszka","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.309006719+01:00","updated_at":"2025-12-30T13:21:24.309006719+01:00","dependencies":[{"issue_id":"dogpile-9yt.18","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.309393397+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.19","title":"Scraper: Fundacja Hakuna Matata","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.3767168+01:00","updated_at":"2025-12-30T13:21:24.3767168+01:00","dependencies":[{"issue_id":"dogpile-9yt.19","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.376977417+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.2","title":"Scraper: Fundacja Azylu pod Psim Aniołem","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.206416123+01:00","updated_at":"2025-12-30T13:21:23.206416123+01:00","dependencies":[{"issue_id":"dogpile-9yt.2","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.206690677+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.20","title":"Scraper: Fundacja Złap Dom","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.444730731+01:00","updated_at":"2025-12-30T13:21:24.444730731+01:00","dependencies":[{"issue_id":"dogpile-9yt.20","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.445027157+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.21","title":"Scraper: Fundacja Trop Warszawa","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.516021786+01:00","updated_at":"2025-12-30T13:21:24.516021786+01:00","dependencies":[{"issue_id":"dogpile-9yt.21","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.516383316+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.22","title":"Scraper: Fundacja Opieki i Rozwoju Humanitares","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.586118121+01:00","updated_at":"2025-12-30T13:21:24.586118121+01:00","dependencies":[{"issue_id":"dogpile-9yt.22","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.586440256+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.23","title":"Scraper: Interwencyjne Centrum Pomocy Kotom","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.65503199+01:00","updated_at":"2025-12-30T13:21:24.65503199+01:00","dependencies":[{"issue_id":"dogpile-9yt.23","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.655387037+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.24","title":"Scraper: Towarzystwo Pomocy Kotom ProFelis","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.724137404+01:00","updated_at":"2025-12-30T13:21:24.724137404+01:00","dependencies":[{"issue_id":"dogpile-9yt.24","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.724431976+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.25","title":"Scraper: Bezdomniaki","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.793710089+01:00","updated_at":"2025-12-30T13:21:24.793710089+01:00","dependencies":[{"issue_id":"dogpile-9yt.25","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:24.79401447+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.3","title":"Scraper: Ochota na Kota","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.275668708+01:00","updated_at":"2025-12-30T13:21:23.275668708+01:00","dependencies":[{"issue_id":"dogpile-9yt.3","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.276003256+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.4","title":"Scraper: Tylko Przyjaciele Zwierząt","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.343214135+01:00","updated_at":"2025-12-30T13:21:23.343214135+01:00","dependencies":[{"issue_id":"dogpile-9yt.4","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.343513316+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.5","title":"Scraper: Schronisko w Celestynowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.411239357+01:00","updated_at":"2025-12-30T13:21:23.411239357+01:00","dependencies":[{"issue_id":"dogpile-9yt.5","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.411500456+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.6","title":"Scraper: Schronisko w Korabiewicach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.48468827+01:00","updated_at":"2025-12-30T13:21:23.48468827+01:00","dependencies":[{"issue_id":"dogpile-9yt.6","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.484963947+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.7","title":"Scraper: Schronisko w Milanówku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.553027643+01:00","updated_at":"2025-12-30T13:21:23.553027643+01:00","dependencies":[{"issue_id":"dogpile-9yt.7","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.553326383+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.8","title":"Scraper: Schronisko w Nowym Dworze Mazowieckim","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.620889674+01:00","updated_at":"2025-12-30T13:21:23.620889674+01:00","dependencies":[{"issue_id":"dogpile-9yt.8","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.621237017+01:00","created_by":"daemon"}]}
{"id":"dogpile-9yt.9","title":"Scraper: Fundacja dla Szczeniąt Judyta","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:23.690064541+01:00","updated_at":"2025-12-30T13:21:23.690064541+01:00","dependencies":[{"issue_id":"dogpile-9yt.9","depends_on_id":"dogpile-9yt","type":"parent-child","created_at":"2025-12-30T13:21:23.690337141+01:00","created_by":"daemon"}]}
{"id":"dogpile-ada","title":"Create prompt template files","description":"Create markdown prompt files that are loaded at runtime. Prompts should NOT be hardcoded in code.\n\n## Directory Structure\n```\npackages/core/prompts/\n├── text-extraction.md     # System prompt for extracting data from shelter text\n├── photo-analysis.md      # System prompt for analyzing dog photos\n├── description-gen.md     # System prompt for generating dog bios\n└── README.md              # Documentation on prompt format and variables\n```\n\n## Prompt File Format\nEach .md file contains:\n1. System prompt content\n2. Variable placeholders using {{VARIABLE}} syntax\n3. Comments (will be stripped) using \u003c!-- --\u003e \n\nExample text-extraction.md:\n```markdown\n\u003c!-- Variables: {{RAW_DESCRIPTION}} --\u003e\n\nJesteś ekspertem w analizie ogłoszeń adopcyjnych psów ze schronisk w Polsce.\n\nTwoim zadaniem jest wyekstrahowanie ustrukturyzowanych danych z tekstu ogłoszenia.\n\n## Zasady\n- Wszystkie pola opcjonalne - użyj null jeśli brak informacji\n- Wiek podaj w miesiącach (1 rok = 12 miesięcy)\n- Rasy wybieraj z podanej listy enum\n...\n```\n\n## Language Rules\n- Prompt content: POLISH (for LLM to respond in Polish)\n- Variable names: ENGLISH\n- Schema field names: ENGLISH\n- Enum values: ENGLISH\n\n## Implementation\n1. Create PromptLoader service that reads .md files\n2. Cache loaded prompts (they don't change at runtime)\n3. Support variable substitution: `{{VAR}}` -\u003e value\n4. Strip HTML comments before sending to LLM\n5. In development, reload on file change (optional)\n\n## Prompt Loading in Workers\nSince Cloudflare Workers can't read filesystem, prompts must be:\n- Bundled at build time (import as string)\n- Or stored in KV and loaded at runtime\n\nRecommend: Bundle at build time using Bun's text loader\n\nLocation: packages/core/prompts/","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:51:15.330965075+01:00","updated_at":"2025-12-28T21:02:48.412425874+01:00","closed_at":"2025-12-28T21:02:48.412425874+01:00","close_reason":"Created Polish prompt templates for AI extraction and bio generation"}
{"id":"dogpile-bbb","title":"[Wielkopolskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:24.862537473+01:00","updated_at":"2025-12-30T13:21:24.862537473+01:00","dependencies":[{"issue_id":"dogpile-bbb","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:24.877106206+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.1","title":"Scraper: Schronisko dla Zwierząt w Poznaniu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.892907392+01:00","updated_at":"2025-12-30T13:21:24.892907392+01:00","dependencies":[{"issue_id":"dogpile-bbb.1","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:24.893176676+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.10","title":"Scraper: Schronisko w Ostrowie Wielkopolskim","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.50741052+01:00","updated_at":"2025-12-30T13:21:25.50741052+01:00","dependencies":[{"issue_id":"dogpile-bbb.10","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.507671478+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.11","title":"Scraper: Schronisko we Wrześni","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.585214204+01:00","updated_at":"2025-12-30T13:21:25.585214204+01:00","dependencies":[{"issue_id":"dogpile-bbb.11","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.590601415+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.12","title":"Scraper: OTOZ Animals Schronisko w Sompolnie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.673957746+01:00","updated_at":"2025-12-30T13:21:25.673957746+01:00","dependencies":[{"issue_id":"dogpile-bbb.12","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.674732835+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.13","title":"Scraper: Przystań dla Zwierząt","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.75210173+01:00","updated_at":"2025-12-30T13:21:25.75210173+01:00","dependencies":[{"issue_id":"dogpile-bbb.13","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.752455195+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.14","title":"Scraper: Schronisko w Lesznie Henrykowo","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.828992883+01:00","updated_at":"2025-12-30T13:21:25.828992883+01:00","dependencies":[{"issue_id":"dogpile-bbb.14","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.829348512+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.15","title":"Scraper: Przytulisko w Wolsztynie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.901517953+01:00","updated_at":"2025-12-30T13:21:25.901517953+01:00","dependencies":[{"issue_id":"dogpile-bbb.15","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.901793759+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.16","title":"Scraper: Fundacja Ochrony Zwierząt AnimaLove","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.972248348+01:00","updated_at":"2025-12-30T13:21:25.972248348+01:00","dependencies":[{"issue_id":"dogpile-bbb.16","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.972556847+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.17","title":"Scraper: Fundacja Sterczące Uszy","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.043703727+01:00","updated_at":"2025-12-30T13:21:26.043703727+01:00","dependencies":[{"issue_id":"dogpile-bbb.17","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:26.044037264+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.18","title":"Scraper: Fundacja Pańska Łaska","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.11487774+01:00","updated_at":"2025-12-30T13:21:26.11487774+01:00","dependencies":[{"issue_id":"dogpile-bbb.18","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:26.115192481+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.19","title":"Scraper: Ja Pacze Sercem","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.186704878+01:00","updated_at":"2025-12-30T13:21:26.186704878+01:00","dependencies":[{"issue_id":"dogpile-bbb.19","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:26.187027874+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.2","title":"Scraper: Schronisko w Skałowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:24.961394496+01:00","updated_at":"2025-12-30T13:21:24.961394496+01:00","dependencies":[{"issue_id":"dogpile-bbb.2","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:24.961714847+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.20","title":"Scraper: Włochata Chata","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.257072672+01:00","updated_at":"2025-12-30T13:21:26.257072672+01:00","dependencies":[{"issue_id":"dogpile-bbb.20","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:26.257426467+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.21","title":"Scraper: Fundacja Benek","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.331732366+01:00","updated_at":"2025-12-30T13:21:26.331732366+01:00","dependencies":[{"issue_id":"dogpile-bbb.21","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:26.33218529+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.3","title":"Scraper: Przytulisko u Wandy","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.029684604+01:00","updated_at":"2025-12-30T13:21:25.029684604+01:00","dependencies":[{"issue_id":"dogpile-bbb.3","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.030008933+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.4","title":"Scraper: Fundacja Dr Lucy","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.098762155+01:00","updated_at":"2025-12-30T13:21:25.098762155+01:00","dependencies":[{"issue_id":"dogpile-bbb.4","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.099056637+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.5","title":"Scraper: Schronisko w Gnieźnie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.166815411+01:00","updated_at":"2025-12-30T13:21:25.166815411+01:00","dependencies":[{"issue_id":"dogpile-bbb.5","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.16709264+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.6","title":"Scraper: Schronisko w Krotoszynie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.236417634+01:00","updated_at":"2025-12-30T13:21:25.236417634+01:00","dependencies":[{"issue_id":"dogpile-bbb.6","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.236724039+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.7","title":"Scraper: Schronisko w Koninie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.303848913+01:00","updated_at":"2025-12-30T13:21:25.303848913+01:00","dependencies":[{"issue_id":"dogpile-bbb.7","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.304113378+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.8","title":"Scraper: Schronisko w Pile Miluszków","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.371861992+01:00","updated_at":"2025-12-30T13:21:25.371861992+01:00","dependencies":[{"issue_id":"dogpile-bbb.8","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.372117821+01:00","created_by":"daemon"}]}
{"id":"dogpile-bbb.9","title":"Scraper: Schronisko w Jędrzejewie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:25.440094521+01:00","updated_at":"2025-12-30T13:21:25.440094521+01:00","dependencies":[{"issue_id":"dogpile-bbb.9","depends_on_id":"dogpile-bbb","type":"parent-child","created_at":"2025-12-30T13:21:25.440364616+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5","title":"[Search] Hybrid Search Implementation","description":"Implement full end-to-end search system with rich embeddings, metadata filtering, and optional query understanding.\n\n## Goal\nEnable users to search for dogs with natural Polish queries like 'szczeniak małej rasy, legnica' and get highly relevant results.\n\n## Architecture\n1. **Rich Search Documents** - Vectorize synthetic Polish text combining structured data + bio\n2. **Metadata Filtering** - Use Cloudflare Vectorize metadata for hard filters (city, size, age)\n3. **Query Understanding (on hold)** - LLM-based query parsing if embeddings aren't enough\n4. **API Search Endpoint** - Vector search with filters, hydrate from D1\n5. **Frontend Search UI** - Search bar with results\n\n## Technical Stack\n- Cloudflare Vectorize (768 dims, cosine, Gemini embeddings)\n- Cloudflare D1 for dog data\n- Effect-TS services\n- Astro + SolidJS frontend\n\n## Success Criteria\n- Search 'szczeniak legnica' returns puppies from Legnica\n- Search 'duży pies do domu z ogrodem' returns large dogs with matching personality\n- Sub-second response times","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T14:02:32.016836199+01:00","updated_at":"2025-12-30T14:02:32.016836199+01:00"}
{"id":"dogpile-bh5.1","title":"Create SearchDocumentBuilder service","description":"Create a new Effect service that builds rich Polish search documents from dog data.\n\n## Location\n`packages/core/src/services/search-document-builder.ts`\n\n## Interface\n```typescript\ninterface SearchDocumentBuilder {\n  buildDocument: (dog: DogRecord) =\u003e string\n  buildMetadata: (dog: DogRecord) =\u003e Record\u003cstring, string\u003e\n}\n```\n\n## buildDocument Output\nGenerate a synthetic Polish text string combining structured data + bio:\n```\nImię: {name}. Rasa: {breeds joined}. Lokalizacja: {city}.\nWiek: {szczeniak|dorosły|senior}. Wielkość: {mały|średni|duży}.\nPłeć: {pies|suczka}. Cechy: {personalityTags joined}.\nZgodność: {z dziećmi, z psami, z kotami - if true}.\n{generatedBio or rawDescription}\n```\n\n## buildMetadata Output\nReturn metadata for Vectorize filtering:\n```typescript\n{\n  city: string,           // normalized lowercase\n  shelterId: string,\n  status: string,         // 'available', 'adopted', etc\n  size: string,           // 'small', 'medium', 'large'\n  ageGroup: string,       // 'puppy' (\u003c12mo), 'adult' (12-84mo), 'senior' (\u003e84mo)\n  sex: string             // 'male', 'female', 'unknown'\n}\n```\n\n## Age/Size Normalization\n- Age: \u003c12 months = 'puppy', 12-84 = 'adult', \u003e84 = 'senior'\n- Size: map sizeEstimate.value to 'small'|'medium'|'large'\n\n## Export\nAdd to `packages/core/src/services/index.ts`","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:03:05.078117154+01:00","updated_at":"2025-12-30T14:03:05.078117154+01:00","dependencies":[{"issue_id":"dogpile-bh5.1","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:03:05.085754606+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.2","title":"Fix embedding model to 768 dimensions","description":"Update embedding configuration to use Gemini model with 768 dimensions.\n\n## Current State\n- Using OpenRouter embeddings with 3072 dimensions\n- Vectorize index configured for 768 dimensions\n- Mismatch causes errors\n\n## Changes Required\n\n### 1. Update AI config\n`packages/core/src/config/ai.ts`\n- Change embeddingModel to Gemini model supporting 768 dims\n- Verify model name: likely `google/text-embedding-004` or similar\n\n### 2. Verify embedding service\n`packages/core/src/services/embedding-impl.ts`\n- Ensure it passes correct model\n- Output should be 768-dim vector\n\n### 3. Test\n- Run embedding on sample text\n- Verify vector length is 768\n\n## Acceptance\n- `embeddingService.embed('test').length === 768`","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:03:23.493808724+01:00","updated_at":"2025-12-30T14:03:23.493808724+01:00","dependencies":[{"issue_id":"dogpile-bh5.2","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:03:23.501258007+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.3","title":"Update embedder worker to use rich documents + metadata","description":"Modify the embedder worker to generate rich search documents and store with metadata.\n\n## Location\n`apps/embedder/src/index.ts`\n\n## Current Flow\n1. Receives reindex job from queue\n2. Embeds just the bio text\n3. Upserts to Vectorize\n\n## New Flow\n1. Receive reindex job with dogId\n2. Fetch full dog record from D1\n3. Use SearchDocumentBuilder.buildDocument() to create rich text\n4. Use SearchDocumentBuilder.buildMetadata() to create filter metadata\n5. Embed the rich document (768 dims)\n6. Upsert to Vectorize with vector + metadata\n\n## Vectorize Upsert Format\n```typescript\nawait env.VECTORIZE.upsert([{\n  id: dogId,\n  values: vector,        // 768-dim array\n  metadata: {\n    city: 'legnica',\n    size: 'medium',\n    ageGroup: 'adult',\n    sex: 'male',\n    shelterId: 'lpgk-legnica',\n    status: 'available'\n  }\n}])\n```\n\n## Dependencies\n- dogpile-bh5.1 (SearchDocumentBuilder)\n- dogpile-bh5.2 (768-dim embeddings)\n\n## Testing\n- Process a dog through embedder\n- Query Vectorize to verify metadata is stored","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:03:35.536756099+01:00","updated_at":"2025-12-30T14:03:35.536756099+01:00","dependencies":[{"issue_id":"dogpile-bh5.3","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:03:35.542368743+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.4","title":"Implement API search endpoint with vector + filters","description":"Create or update the /dogs/search API endpoint to use Vectorize with metadata filtering.\n\n## Location\n`apps/api/src/index.ts`\n\n## Endpoint\n`GET /dogs/search?q={query}\u0026city={city}\u0026size={size}\u0026age={ageGroup}`\n\n## Flow\n1. Parse query params:\n   - q: search text (required)\n   - city, size, age: optional filters\n2. Embed the query text (768 dims)\n3. Build Vectorize filter from params\n4. Query Vectorize:\n```typescript\nconst results = await env.VECTORIZE.query(queryVector, {\n  topK: 20,\n  filter: {\n    ...(city \u0026\u0026 { city: city.toLowerCase() }),\n    ...(size \u0026\u0026 { size }),\n    ...(age \u0026\u0026 { ageGroup: age }),\n    status: 'available'\n  }\n})\n```\n5. Extract dog IDs from results\n6. Fetch full dog records from D1\n7. Return ordered by vector similarity score\n\n## Response Format\n```json\n{\n  \"dogs\": [...],\n  \"total\": 15,\n  \"query\": { \"text\": \"...\", \"filters\": {...} }\n}\n```\n\n## Error Handling\n- Empty query: return validation error\n- No results: return empty array, not error\n\n## Dependencies\n- dogpile-bh5.2 (embedding service)\n- dogpile-bh5.3 (data in Vectorize with metadata)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:03:47.46352518+01:00","updated_at":"2025-12-30T14:03:47.46352518+01:00","dependencies":[{"issue_id":"dogpile-bh5.4","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:03:47.470066067+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.5","title":"Reindex all dogs with new search documents","description":"One-time migration to reindex all existing dogs with rich documents and metadata.\n\n## Context\nAfter implementing new embedding pipeline, all existing dogs need reindexing.\n\n## Options\n\n### Option A: CLI command\nAdd to `packages/scrapers/src/cli.ts`:\n```bash\nbun run src/cli.ts reindex-all\n```\n- Fetches all dogs from D1\n- For each dog: build document, embed, upsert to Vectorize\n\n### Option B: Queue-based\n- Enqueue all dog IDs to REINDEX_QUEUE\n- Let embedder worker process them\n\n## Recommended: Option A for initial migration\n- More control, can see progress\n- Can limit concurrency to avoid rate limits\n\n## Implementation\n```typescript\nconst reindexAllCommand = () =\u003e Effect.gen(function* () {\n  // Fetch all dog IDs from D1\n  // For each batch of 10:\n  //   - Build search documents\n  //   - Embed batch\n  //   - Upsert to Vectorize\n  // Log progress\n})\n```\n\n## Dependencies\n- dogpile-bh5.1, dogpile-bh5.2, dogpile-bh5.3\n\n## Verification\n- Query Vectorize count matches D1 dog count\n- Sample search returns expected results","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:03:59.138694796+01:00","updated_at":"2025-12-30T14:03:59.138694796+01:00","dependencies":[{"issue_id":"dogpile-bh5.5","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:03:59.14399857+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.6","title":"Add search UI to frontend","description":"Implement search bar and results display in the Astro/SolidJS frontend.\n\n## Location\n`apps/web/src/components/`\n\n## Components\n\n### 1. SearchBar.tsx (new)\n- Text input for search query\n- Optional filter dropdowns/chips: size, age, city\n- Debounced search (300ms)\n- Submit on Enter or button click\n\n### 2. SearchResults.tsx (new)\n- Receives search results from API\n- Displays as grid of DogCards (reuse existing)\n- Shows 'no results' state\n- Shows loading state\n\n### 3. Update index.astro or create search page\n- Add SearchBar to hero or as separate /search page\n- Wire up to /dogs/search API endpoint\n\n## API Integration\n```typescript\nconst searchDogs = async (query: string, filters: Filters) =\u003e {\n  const params = new URLSearchParams({ q: query, ...filters })\n  const res = await fetch(`${API_URL}/dogs/search?${params}`)\n  return res.json()\n}\n```\n\n## UX Considerations\n- Show search suggestions? (future)\n- Preserve search in URL for sharing\n- Mobile-friendly filter UI\n\n## Dependencies\n- dogpile-bh5.4 (API endpoint)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:04:12.525756996+01:00","updated_at":"2025-12-30T14:04:12.525756996+01:00","dependencies":[{"issue_id":"dogpile-bh5.6","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:04:12.537859007+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.7","title":"Query understanding with LLM parsing","description":"Parse natural language queries into semantic text + structured filters using LLM.\n\n## Status: ON HOLD\nImplement only if rich embeddings + manual filters aren't enough.\n\n## Concept\nUser types: 'szczeniak małej rasy, legnica'\nLLM extracts:\n```json\n{\n  \"semanticQuery\": \"szczeniak małej rasy\",\n  \"filters\": {\n    \"city\": \"Legnica\",\n    \"ageGroup\": \"puppy\",\n    \"size\": \"small\"\n  }\n}\n```\n\n## Implementation\n\n### 1. QueryParser service\n`packages/core/src/services/query-parser.ts`\n```typescript\ninterface QueryParser {\n  parse: (rawQuery: string) =\u003e Effect\u003cParsedQuery, ParseError\u003e\n}\n\ninterface ParsedQuery {\n  semanticQuery: string\n  filters: {\n    city?: string\n    size?: 'small' | 'medium' | 'large'\n    ageGroup?: 'puppy' | 'adult' | 'senior'\n    sex?: 'male' | 'female'\n  }\n}\n```\n\n### 2. Use fast model\n- Gemini Flash or Claude Haiku\n- Structured output with Schema validation\n\n### 3. Prompt template\n`packages/core/prompts/query-parse.md`\n- Polish language examples\n- Output JSON schema\n\n### 4. Integration\n- Update /dogs/search to optionally use QueryParser\n- Feature flag to enable/disable\n\n## Why on hold\n- Adds latency (~200-500ms)\n- Adds cost per search\n- May not be needed if embeddings are good enough","status":"deferred","priority":2,"issue_type":"task","created_at":"2025-12-30T14:04:27.136166461+01:00","updated_at":"2025-12-30T14:04:44.112174037+01:00","dependencies":[{"issue_id":"dogpile-bh5.7","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:04:27.148369636+01:00","created_by":"daemon"}]}
{"id":"dogpile-bh5.8","title":"E2E search testing and validation","description":"Validate search quality with real queries before shipping.\n\n## Test Queries (Polish)\n1. 'szczeniak' → should return dogs with ageGroup=puppy\n2. 'duży pies' → should return dogs with size=large\n3. 'legnica' → should return dogs from Legnica\n4. 'szczeniak małej rasy legnica' → combined filters\n5. 'spokojny pies dla seniora' → semantic match on personality\n6. 'przyjazny dla dzieci' → should match goodWithKids=true dogs\n7. 'husky' → should match breed estimates\n\n## Validation Criteria\n- Top 3 results should be relevant for each query\n- No timeout errors\n- Response time \u003c 500ms\n\n## Test Script\nAdd to CLI or create test file:\n```typescript\nconst testQueries = [\n  { q: 'szczeniak', expect: { ageGroup: 'puppy' } },\n  { q: 'duży pies', expect: { size: 'large' } },\n  // ...\n]\n```\n\n## Dependencies\n- All other tasks complete","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T14:04:59.008946082+01:00","updated_at":"2025-12-30T14:04:59.008946082+01:00","dependencies":[{"issue_id":"dogpile-bh5.8","depends_on_id":"dogpile-bh5","type":"parent-child","created_at":"2025-12-30T14:04:59.014391755+01:00","created_by":"daemon"}]}
{"id":"dogpile-cv8","title":"Implement EmbeddingService","description":"Create EmbeddingService Effect service for generating vector embeddings.\n\n## Depends on\n- OpenRouterClient (dogpile-czv)\n- AI Config (dogpile-u1d)\n\n## Interface\n```typescript\ninterface EmbeddingService {\n  embed: (text: string) =\u003e Effect\u003creadonly number[], EmbeddingError\u003e\n  embedBatch: (texts: readonly string[]) =\u003e Effect\u003creadonly (readonly number[])[], EmbeddingError\u003e\n}\n```\n\n## Implementation\n1. Use OpenRouterClient.embeddings() with MODEL_EMBEDDING\n2. Default model: google/gemini-embedding-001 (good for Polish)\n3. Batch requests for efficiency (Embeddings API supports array input)\n\n## API Call\n```typescript\nPOST /api/v1/embeddings\n{\n  model: 'google/gemini-embedding-001',\n  input: ['text1', 'text2', ...]\n}\n```\n\n## Response\n```typescript\n{\n  data: [\n    { embedding: number[], index: 0 },\n    { embedding: number[], index: 1 },\n    ...\n  ]\n}\n```\n\n## Usage\n- Called by embedder worker for new dogs\n- Called by API worker for search queries\n- Cache embeddings - they're deterministic\n\nLocation: packages/core/src/services/ai/embedding.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:43:09.574307686+01:00","updated_at":"2025-12-28T21:07:23.014162817+01:00","closed_at":"2025-12-28T21:07:23.014162817+01:00","close_reason":"Implemented EmbeddingService with OpenRouter embeddings","dependencies":[{"issue_id":"dogpile-cv8","depends_on_id":"dogpile-czv","type":"blocks","created_at":"2025-12-28T20:43:22.014279449+01:00","created_by":"daemon"},{"issue_id":"dogpile-cv8","depends_on_id":"dogpile-u1d","type":"blocks","created_at":"2025-12-28T20:43:22.029780721+01:00","created_by":"daemon"}]}
{"id":"dogpile-czv","title":"Create OpenRouterClient base service","description":"Implement low-level OpenRouterClient Effect service for all OpenRouter API interactions.\n\n## Endpoints\n- Responses API: POST /api/v1/responses (new stateless API, NOT legacy /chat/completions)\n- Embeddings API: POST /api/v1/embeddings\n\n## Responsibilities\n- Authentication: Bearer token from OPENROUTER_API_KEY\n- Retry logic: Exponential backoff on 429 (rate limit) and 5xx errors\n- Error mapping to tagged Effect errors\n\n## Methods\n```typescript\ninterface OpenRouterClient {\n  responses: (request: ResponsesRequest) =\u003e Effect\u003cResponsesResult, OpenRouterError\u003e\n  embeddings: (request: EmbeddingsRequest) =\u003e Effect\u003cEmbeddingsResult, OpenRouterError\u003e\n}\n```\n\n## Error Types\n- OpenRouterError: { status, body, code }\n- RateLimitError: extends OpenRouterError (triggers retry)\n- SchemaValidationError: { issues } (response didn't match expected schema)\n\n## Configuration\nRead from Effect.Config:\n- OPENROUTER_API_KEY (secret, required)\n- OPENROUTER_BASE_URL (optional, default https://openrouter.ai/api/v1)\n\nLocation: packages/core/src/services/openrouter/client.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:41:35.089339+01:00","updated_at":"2025-12-28T21:00:44.690824759+01:00","closed_at":"2025-12-28T21:00:44.690824759+01:00","close_reason":"Implemented OpenRouterClient with responses/embeddings endpoints, retry logic, and proper config"}
{"id":"dogpile-d52","title":"[Podkarpackie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:34.134026941+01:00","updated_at":"2025-12-30T13:21:34.134026941+01:00","dependencies":[{"issue_id":"dogpile-d52","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:34.150595322+01:00","created_by":"daemon"}]}
{"id":"dogpile-d52.1","title":"Scraper: Schronisko w Rzeszowie Kundelek","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:34.16851479+01:00","updated_at":"2025-12-30T13:21:34.16851479+01:00","dependencies":[{"issue_id":"dogpile-d52.1","depends_on_id":"dogpile-d52","type":"parent-child","created_at":"2025-12-30T13:21:34.168879957+01:00","created_by":"daemon"}]}
{"id":"dogpile-d52.2","title":"Scraper: Schronisko w Mielcu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:34.238946806+01:00","updated_at":"2025-12-30T13:21:34.238946806+01:00","dependencies":[{"issue_id":"dogpile-d52.2","depends_on_id":"dogpile-d52","type":"parent-child","created_at":"2025-12-30T13:21:34.239314358+01:00","created_by":"daemon"}]}
{"id":"dogpile-d52.3","title":"Scraper: Schronisko w Orzechowcach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:34.310359274+01:00","updated_at":"2025-12-30T13:21:34.310359274+01:00","dependencies":[{"issue_id":"dogpile-d52.3","depends_on_id":"dogpile-d52","type":"parent-child","created_at":"2025-12-30T13:21:34.310658916+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw","title":"[Pomorskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:28.490403561+01:00","updated_at":"2025-12-30T13:21:28.490403561+01:00","dependencies":[{"issue_id":"dogpile-ejw","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:28.50816573+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.1","title":"Scraper: Schronisko Promyk w Gdańsku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.527947372+01:00","updated_at":"2025-12-30T13:21:28.527947372+01:00","dependencies":[{"issue_id":"dogpile-ejw.1","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.528341464+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.2","title":"Scraper: Schronisko w Gdyni Ciapkowo","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.600549129+01:00","updated_at":"2025-12-30T13:21:28.600549129+01:00","dependencies":[{"issue_id":"dogpile-ejw.2","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.600865833+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.3","title":"Scraper: Schronisko w Tczewie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.673756061+01:00","updated_at":"2025-12-30T13:21:28.673756061+01:00","dependencies":[{"issue_id":"dogpile-ejw.3","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.674099456+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.4","title":"Scraper: Schronisko w Dąbrówce","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.743437093+01:00","updated_at":"2025-12-30T13:21:28.743437093+01:00","dependencies":[{"issue_id":"dogpile-ejw.4","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.743800367+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.5","title":"Scraper: Schronisko w Słupsku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.813931268+01:00","updated_at":"2025-12-30T13:21:28.813931268+01:00","dependencies":[{"issue_id":"dogpile-ejw.5","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.814238584+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.6","title":"Scraper: Schronisko w Starogardzie Gdańskim","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.885622537+01:00","updated_at":"2025-12-30T13:21:28.885622537+01:00","dependencies":[{"issue_id":"dogpile-ejw.6","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.885924784+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.7","title":"Scraper: Schronisko w Chojnicach Przytulisko","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.956116602+01:00","updated_at":"2025-12-30T13:21:28.956116602+01:00","dependencies":[{"issue_id":"dogpile-ejw.7","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:28.956434729+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.8","title":"Scraper: Schronisko w Elblągu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.026701179+01:00","updated_at":"2025-12-30T13:21:29.026701179+01:00","dependencies":[{"issue_id":"dogpile-ejw.8","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:29.027027091+01:00","created_by":"daemon"}]}
{"id":"dogpile-ejw.9","title":"Scraper: Stacja Morska w Helu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.1015529+01:00","updated_at":"2025-12-30T13:21:29.1015529+01:00","dependencies":[{"issue_id":"dogpile-ejw.9","depends_on_id":"dogpile-ejw","type":"parent-child","created_at":"2025-12-30T13:21:29.101908849+01:00","created_by":"daemon"}]}
{"id":"dogpile-fhe","title":"Shelter Scrapers Implementation","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:23.087114572+01:00","updated_at":"2025-12-30T13:21:23.087114572+01:00"}
{"id":"dogpile-hjs","title":"Wire AI extraction into scraper-processor pipeline","description":"Integrate AIExtractionService into scraper-processor worker.\n\nFlow:\n1. Scraper returns RawDogData with fingerprint + rawDescription\n2. If new dog (fingerprint not in DB):\n   - Run text extraction on rawDescription\n   - Download photos to R2\n   - Run photo extraction on photos\n   - Merge results and store in D1\n   - Queue for embedding generation\n3. If existing dog (fingerprint match):\n   - Just update lastSeenAt\n\nRequires dogpile-4jr (AIExtractionService) and dogpile-2o2 (shelter adapter) to be complete.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:32:45.042624916+01:00","updated_at":"2025-12-29T00:07:44.509388314+01:00","closed_at":"2025-12-29T00:07:44.509388314+01:00","close_reason":"Integrated AI extraction into scraper-processor pipeline","dependencies":[{"issue_id":"dogpile-hjs","depends_on_id":"dogpile-4jr","type":"blocks","created_at":"2025-12-28T20:32:59.76429578+01:00","created_by":"daemon"},{"issue_id":"dogpile-hjs","depends_on_id":"dogpile-2o2","type":"blocks","created_at":"2025-12-28T20:33:05.98802271+01:00","created_by":"daemon"},{"issue_id":"dogpile-hjs","depends_on_id":"dogpile-zv5","type":"blocks","created_at":"2025-12-28T20:43:31.530020352+01:00","created_by":"daemon"},{"issue_id":"dogpile-hjs","depends_on_id":"dogpile-we6","type":"blocks","created_at":"2025-12-28T20:43:31.551671635+01:00","created_by":"daemon"},{"issue_id":"dogpile-hjs","depends_on_id":"dogpile-7we","type":"blocks","created_at":"2025-12-28T20:43:31.56704343+01:00","created_by":"daemon"},{"issue_id":"dogpile-hjs","depends_on_id":"dogpile-cv8","type":"blocks","created_at":"2025-12-28T20:43:31.582608143+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0","title":"[Śląskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:26.403603167+01:00","updated_at":"2025-12-30T13:21:26.403603167+01:00","dependencies":[{"issue_id":"dogpile-hp0","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:26.419827591+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.1","title":"Scraper: Schronisko w Katowicach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.442497415+01:00","updated_at":"2025-12-30T13:21:26.442497415+01:00","dependencies":[{"issue_id":"dogpile-hp0.1","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.442817746+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.10","title":"Scraper: Fundacja Szara Przystań","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.085179581+01:00","updated_at":"2025-12-30T13:21:27.085179581+01:00","dependencies":[{"issue_id":"dogpile-hp0.10","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.085486387+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.11","title":"Scraper: Stowarzyszenie DoberMania","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.154434381+01:00","updated_at":"2025-12-30T13:21:27.154434381+01:00","dependencies":[{"issue_id":"dogpile-hp0.11","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.154772847+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.12","title":"Scraper: Stowarzyszenie Kocimiętka","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.22455375+01:00","updated_at":"2025-12-30T13:21:27.22455375+01:00","dependencies":[{"issue_id":"dogpile-hp0.12","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.224899279+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.13","title":"Scraper: Rzecz Psów Północy OKIEM WILKA","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.295136634+01:00","updated_at":"2025-12-30T13:21:27.295136634+01:00","dependencies":[{"issue_id":"dogpile-hp0.13","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.29544879+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.14","title":"Scraper: Fundacja Mam kota na punkcie ps","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.365869714+01:00","updated_at":"2025-12-30T13:21:27.365869714+01:00","dependencies":[{"issue_id":"dogpile-hp0.14","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.366206086+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.15","title":"Scraper: Fundacja Cieszyński Zwierzogród","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.435904993+01:00","updated_at":"2025-12-30T13:21:27.435904993+01:00","dependencies":[{"issue_id":"dogpile-hp0.15","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.436222649+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.2","title":"Scraper: Schronisko Psitulmnie w Zabrzu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.511368712+01:00","updated_at":"2025-12-30T13:21:26.511368712+01:00","dependencies":[{"issue_id":"dogpile-hp0.2","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.511686088+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.3","title":"Scraper: Schronisko w Chorzowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.582958448+01:00","updated_at":"2025-12-30T13:21:26.582958448+01:00","dependencies":[{"issue_id":"dogpile-hp0.3","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.58331088+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.4","title":"Scraper: Schronisko w Częstochowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.655472006+01:00","updated_at":"2025-12-30T13:21:26.655472006+01:00","dependencies":[{"issue_id":"dogpile-hp0.4","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.655793299+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.5","title":"Scraper: Schronisko w Bytomiu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.727051071+01:00","updated_at":"2025-12-30T13:21:26.727051071+01:00","dependencies":[{"issue_id":"dogpile-hp0.5","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.727382684+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.6","title":"Scraper: Schronisko w Sosnowcu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.802491576+01:00","updated_at":"2025-12-30T13:21:26.802491576+01:00","dependencies":[{"issue_id":"dogpile-hp0.6","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.802825683+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.7","title":"Scraper: Schronisko w Tychach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.873843999+01:00","updated_at":"2025-12-30T13:21:26.873843999+01:00","dependencies":[{"issue_id":"dogpile-hp0.7","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.874347229+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.8","title":"Scraper: Schronisko w Bielsku-Białej","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:26.944489772+01:00","updated_at":"2025-12-30T13:21:26.944489772+01:00","dependencies":[{"issue_id":"dogpile-hp0.8","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:26.944820603+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp0.9","title":"Scraper: Schronisko w Rybniku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.014406975+01:00","updated_at":"2025-12-30T13:21:27.014406975+01:00","dependencies":[{"issue_id":"dogpile-hp0.9","depends_on_id":"dogpile-hp0","type":"parent-child","created_at":"2025-12-30T13:21:27.014722337+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp7","title":"[Podlaskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:31.363447638+01:00","updated_at":"2025-12-30T13:21:31.363447638+01:00","dependencies":[{"issue_id":"dogpile-hp7","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:31.378578634+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp7.1","title":"Scraper: Schronisko w Białymstoku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.395972871+01:00","updated_at":"2025-12-30T13:21:31.395972871+01:00","dependencies":[{"issue_id":"dogpile-hp7.1","depends_on_id":"dogpile-hp7","type":"parent-child","created_at":"2025-12-30T13:21:31.396233117+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp7.2","title":"Scraper: Schronisko w Suwałkach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.464597338+01:00","updated_at":"2025-12-30T13:21:31.464597338+01:00","dependencies":[{"issue_id":"dogpile-hp7.2","depends_on_id":"dogpile-hp7","type":"parent-child","created_at":"2025-12-30T13:21:31.464901708+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp7.3","title":"Scraper: Schronisko Cyganowo","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.534603561+01:00","updated_at":"2025-12-30T13:21:31.534603561+01:00","dependencies":[{"issue_id":"dogpile-hp7.3","depends_on_id":"dogpile-hp7","type":"parent-child","created_at":"2025-12-30T13:21:31.534895398+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp7.4","title":"Scraper: Schronisko w Łomży","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.609304073+01:00","updated_at":"2025-12-30T13:21:31.609304073+01:00","dependencies":[{"issue_id":"dogpile-hp7.4","depends_on_id":"dogpile-hp7","type":"parent-child","created_at":"2025-12-30T13:21:31.60960125+01:00","created_by":"daemon"}]}
{"id":"dogpile-hp7.5","title":"Scraper: Azyl w Mikołajewie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:31.688179774+01:00","updated_at":"2025-12-30T13:21:31.688179774+01:00","dependencies":[{"issue_id":"dogpile-hp7.5","depends_on_id":"dogpile-hp7","type":"parent-child","created_at":"2025-12-30T13:21:31.688579898+01:00","created_by":"daemon"}]}
{"id":"dogpile-hsn","title":"[Web] Dog Page \u0026 Image Performance Improvements","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-31T02:02:38.643925869+01:00","updated_at":"2025-12-31T02:02:38.643925869+01:00"}
{"id":"dogpile-hsn.1","title":"Fix dog page photo aspect ratio","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-31T02:03:41.039053541+01:00","updated_at":"2026-01-04T16:29:12.082046049+01:00","dependencies":[{"issue_id":"dogpile-hsn.1","depends_on_id":"dogpile-hsn","type":"parent-child","created_at":"2025-12-31T02:03:41.045516326+01:00","created_by":"daemon"}],"comments":[{"id":2,"issue_id":"dogpile-hsn.1","author":"ribelo","text":"## Problem\nDog detail page at apps/web/src/pages/dogs/[id].astro:34 sets ImageSlider with aspect-[4/3] but photos are 4:5 ratio.\n\n## Current Code\nThe polaroid div wraps ImageSlider with class=\"w-full aspect-[4/3] rounded-sm\"\n\n## Fix\nChange aspect-[4/3] to aspect-[4/5] to match the actual photo proportions.\nThe DogCard already uses correct aspect-[4/5] at apps/web/src/components/DogCard.tsx:55.\n\n## Files to Modify\n- apps/web/src/pages/dogs/[id].astro line 34\n\n## Testing\n- Open dog detail page\n- Verify photo fills container without distortion\n- Check both scraped and AI-generated photos display correctly","created_at":"2025-12-31T01:04:12Z"}]}
{"id":"dogpile-hsn.2","title":"Add auto-slideshow to ImageSlider","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-31T02:04:17.282519716+01:00","updated_at":"2026-01-04T16:29:12.106086955+01:00","dependencies":[{"issue_id":"dogpile-hsn.2","depends_on_id":"dogpile-hsn","type":"parent-child","created_at":"2025-12-31T02:04:17.292610952+01:00","created_by":"daemon"}],"comments":[{"id":3,"issue_id":"dogpile-hsn.2","author":"ribelo","text":"## Problem\nOn dog detail page, images don't rotate automatically. User must click arrows to see all photos.\n\n## Location\napps/web/src/components/ImageSlider.tsx\n\n## Requirements\n1. Add optional autoPlay prop (default: false for cards, true for detail page)\n2. Auto-advance every 4-5 seconds when autoPlay=true\n3. Pause on hover (user interaction should stop auto-advance)\n4. Resume after mouse leaves\n5. Pause when user manually clicks prev/next (optional: resume after 10s idle)\n\n## Implementation\n\nAdd to ImageSlider.tsx:\n```tsx\ninterface Props {\n  photos: string[]\n  photosGenerated: string[]\n  alt: string\n  class?: string\n  autoPlay?: boolean      // NEW\n  autoPlayInterval?: number // NEW (default 4000ms)\n}\n\n// Inside component:\nconst [isPaused, setIsPaused] = createSignal(false)\n\ncreateEffect(() =\u003e {\n  if (!props.autoPlay || allPhotos().length \u003c= 1) return\n  \n  const interval = setInterval(() =\u003e {\n    if (!isPaused()) {\n      setIndex(i =\u003e (i + 1) % allPhotos().length)\n    }\n  }, props.autoPlayInterval || 4000)\n  \n  onCleanup(() =\u003e clearInterval(interval))\n})\n\n// Add onMouseEnter/onMouseLeave to root div:\nonMouseEnter={() =\u003e setIsPaused(true)}\nonMouseLeave={() =\u003e setIsPaused(false)}\n```\n\n## Files to Modify\n- apps/web/src/components/ImageSlider.tsx\n- apps/web/src/pages/dogs/[id].astro (add autoPlay={true})\n\n## Testing\n- Open dog detail page, wait 4s, verify image changes\n- Hover over image, verify slideshow pauses\n- Move mouse away, verify slideshow resumes\n- Click arrows, verify still works manually","created_at":"2025-12-31T01:04:30Z"}]}
{"id":"dogpile-hsn.3","title":"Fix LPGK Legnica scraper sourceUrl","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-31T02:04:35.985289917+01:00","updated_at":"2026-01-04T14:57:50.343192584+01:00","closed_at":"2026-01-04T14:57:50.343192584+01:00","close_reason":"Fixed sourceUrl preservation in transform function","dependencies":[{"issue_id":"dogpile-hsn.3","depends_on_id":"dogpile-hsn","type":"parent-child","created_at":"2025-12-31T02:04:35.997317502+01:00","created_by":"daemon"}],"comments":[{"id":4,"issue_id":"dogpile-hsn.3","author":"ribelo","text":"## Problem\nThe 'say hello to [dog]' button on dog detail page links to the category page instead of the individual dog page.\n\nExample: Hugo's page shows:\n```html\n\u003ca href=\"https://lpgk.eu/category/psy-do-adopcji/\" ...\u003esay hello to HUGO\u003c/a\u003e\n```\n\nShould link to: https://lpgk.eu/hugo/\n\n## Root Cause\nThe scraper at packages/scrapers/src/adapters/lpgk-legnica.ts correctly scrapes individual dog pages and sets sourceUrl to the dog's page URL (line 62: sourceUrl: url). However, looking at the transform function (line 98-106), it falls back to SOURCE_URL if raw.sourceUrl is undefined.\n\nThe issue is that the RawDogData interface or the transform is not preserving the individual URL properly.\n\n## Current Code (lpgk-legnica.ts)\n```typescript\n// In parse function - correctly sets individual URL:\nreturn {\n  fingerprint: `${SHELTER_ID}:${externalId}`,\n  externalId,\n  name,\n  rawDescription,\n  photos,\n  sex: \"unknown\" as const,\n  sourceUrl: url,  // This is the individual dog page URL like https://lpgk.eu/hugo/\n} satisfies RawDogData\n\n// In transform function:\ntransform: (raw, config) =\u003e\n  Effect.succeed({\n    shelterId: config.shelterId,\n    externalId: raw.externalId,\n    fingerprint: raw.fingerprint,\n    name: raw.name,\n    sex: raw.sex ?? \"unknown\",\n    rawDescription: raw.rawDescription,\n    sourceUrl: raw.sourceUrl ?? SOURCE_URL,  // Falls back to category page\n    photos: raw.photos ?? [],\n  }),\n```\n\n## Investigation Needed\n1. Check if raw.sourceUrl is being passed correctly through the pipeline\n2. Verify the DB is storing the correct URL\n3. Check API response includes correct sourceUrl\n\n## Files to Check\n- packages/scrapers/src/adapters/lpgk-legnica.ts\n- packages/scrapers/src/adapter.ts (RawDogData interface)\n- apps/scraper-processor/src/index.ts (how sourceUrl is saved to DB)\n- apps/api/src/index.ts (how sourceUrl is returned in API)\n\n## Testing\n1. Re-run scraper for LPGK Legnica\n2. Query DB: SELECT source_url FROM dogs WHERE shelter_id = 'lpgk-legnica' LIMIT 5\n3. Verify API returns correct sourceUrl\n4. Check dog detail page button links to individual page","created_at":"2025-12-31T01:04:55Z"}]}
{"id":"dogpile-hsn.4","title":"Add Polish translations to dog detail page","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-31T02:05:00.621011555+01:00","updated_at":"2026-01-04T16:29:12.121007396+01:00","dependencies":[{"issue_id":"dogpile-hsn.4","depends_on_id":"dogpile-hsn","type":"parent-child","created_at":"2025-12-31T02:05:00.629954754+01:00","created_by":"daemon"}],"comments":[{"id":5,"issue_id":"dogpile-hsn.4","author":"ribelo","text":"## Problem\nDog detail page at apps/web/src/pages/dogs/[id].astro has hardcoded English text.\n\n## Strings to Translate\n\n| Current English | Polish Translation | Key |\n|----------------|-------------------|-----|\n| Back to the pile | Wróć do stosu | dogPage.backToList |\n| URGENT! | PILNE! | card.urgent |\n| Looking for a soft place to land | Szuka miękkiego miejsca do lądowania | dogPage.subtitle |\n| Age | Wiek | dogPage.age |\n| Size | Rozmiar | dogPage.size |\n| Breed | Rasa | dogPage.breed |\n| Location | Lokalizacja | dogPage.location |\n| years | lat | card.years |\n| Good with kids | Dobry z dziećmi | dogPage.goodWithKids |\n| Good with dogs | Dobry z psami | dogPage.goodWithDogs |\n| Good with cats | Dobry z kotami | dogPage.goodWithCats |\n| Vaccinated | Zaszczepiony | dogPage.vaccinated |\n| Sterilized | Wysterylizowany | dogPage.sterilized |\n| Chipped | Zaczipowany | dogPage.chipped |\n| say hello to [name] | przywitaj się z [name] | dogPage.sayHello |\n| About this friend | O tym przyjacielu | dogPage.aboutTitle |\n| Vibe Check | Sprawdź charakter | dogPage.vibeCheck |\n\n## Implementation\n\n1. Add keys to apps/web/src/i18n/pl.json and en.json under 'dogPage' section\n2. Import t from '../i18n' in dogs/[id].astro\n3. Replace all hardcoded strings with t() calls\n4. For 'say hello to [name]', use template: t('dogPage.sayHello').replace('[name]', dog.name)\n\n## Files to Modify\n- apps/web/src/i18n/pl.json\n- apps/web/src/i18n/en.json  \n- apps/web/src/pages/dogs/[id].astro\n\n## Testing\n- Set language to Polish via LanguageSwitcher\n- Navigate to dog detail page\n- Verify all text displays in Polish\n- Switch to English, verify English text","created_at":"2025-12-31T01:05:16Z"}]}
{"id":"dogpile-hsn.5","title":"Add image prefetching to ImageSlider","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T02:05:22.240814569+01:00","updated_at":"2026-01-04T16:30:19.321798528+01:00","closed_at":"2026-01-04T16:30:19.321798528+01:00","close_reason":"Closed","dependencies":[{"issue_id":"dogpile-hsn.5","depends_on_id":"dogpile-hsn","type":"parent-child","created_at":"2025-12-31T02:05:22.252555947+01:00","created_by":"daemon"},{"issue_id":"dogpile-hsn.5","depends_on_id":"dogpile-9oj","type":"related","created_at":"2025-12-31T02:08:29.354930579+01:00","created_by":"daemon"}],"comments":[{"id":6,"issue_id":"dogpile-hsn.5","author":"ribelo","text":"## Problem\nClicking next/prev in ImageSlider is slow because images load on-demand. No prefetching.\n\n## Solution\nPrefetch the next (and optionally previous) images in the background.\n\n## Implementation\n\n### Option A: Preload with \u003clink rel='preload'\u003e (recommended)\nAdd hidden Image elements or link preload tags for adjacent images:\n\n```tsx\n// In ImageSlider.tsx\nimport { createEffect, onMount } from 'solid-js'\n\n// Prefetch next 2 images\ncreateEffect(() =\u003e {\n  const photos = allPhotos()\n  const current = index()\n  \n  // Prefetch next 2 images\n  for (let offset = 1; offset \u003c= 2; offset++) {\n    const nextIdx = (current + offset) % photos.length\n    const img = new Image()\n    img.src = photos[nextIdx]\n  }\n})\n\n// Alternative: onMount prefetch ALL images\nonMount(() =\u003e {\n  allPhotos().forEach(url =\u003e {\n    const img = new Image()\n    img.src = url\n  })\n})\n```\n\n### Option B: Intersection Observer + Eager Loading\nFor DogCard grid, use intersection observer to prefetch when card enters viewport.\n\n### Option C: CSS-only with hidden img tags\n```tsx\n{/* Hidden preload images */}\n\u003cdiv class=\"hidden\"\u003e\n  {allPhotos().map(url =\u003e \u003cimg src={url} alt=\"\" /\u003e)}\n\u003c/div\u003e\n```\n\n## Recommended Approach\n- Use Option A with createEffect for ImageSlider\n- Prefetch only next 2 images (not all) to avoid bandwidth waste\n- On dog detail page, prefetch all images on mount since user will likely view them\n\n## Files to Modify\n- apps/web/src/components/ImageSlider.tsx\n\n## Testing\n- Open dog detail page with multiple photos\n- Click through images quickly\n- Verify transitions are instant (no loading flash)\n- Check Network tab - images should be cached before viewing","created_at":"2025-12-31T01:05:37Z"}]}
{"id":"dogpile-io3","title":"Add generatedBio field to Dog schema","description":"Update Dog schema to store AI-generated biography separately from rawDescription.\n\n## Schema Changes\n```sql\ndog:\n  + generatedBio TEXT     -- AI-generated 'Dogpile style' description\n  + bioGeneratedAt INTEGER -- When bio was generated (for cache invalidation)\n```\n\n## Domain Type Update\npackages/core/src/domain/dog.ts:\n```typescript\ngeneratedBio: Schema.NullOr(Schema.String),\nbioGeneratedAt: Schema.NullOr(Schema.Date),\n```\n\n## Frontend Display Logic\n- If generatedBio exists: show it\n- If not: show rawDescription as fallback\n- Never show both\n\n## Migration\n- Add columns to existing dogs table\n- Set generatedBio = null initially\n- Bio will be generated on next scrape or via backfill job","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T20:43:53.456553771+01:00","updated_at":"2025-12-29T00:11:05.377889149+01:00","closed_at":"2025-12-29T00:11:05.377889149+01:00","close_reason":"Added generatedBio field to Dog domain and DB schema","dependencies":[{"issue_id":"dogpile-io3","depends_on_id":"dogpile-7we","type":"related","created_at":"2025-12-28T20:44:01.049570611+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg","title":"[Łódzkie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:29.867911869+01:00","updated_at":"2025-12-30T13:21:29.867911869+01:00","dependencies":[{"issue_id":"dogpile-lgg","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:29.882773933+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.1","title":"Scraper: Schronisko w Łodzi","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.899108015+01:00","updated_at":"2025-12-30T13:21:29.899108015+01:00","dependencies":[{"issue_id":"dogpile-lgg.1","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:29.899407066+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.10","title":"Scraper: Schronisko w Jasionce","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.549243208+01:00","updated_at":"2025-12-30T13:21:30.549243208+01:00","dependencies":[{"issue_id":"dogpile-lgg.10","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.549562387+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.11","title":"Scraper: Schronisko w Rytlowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.618366877+01:00","updated_at":"2025-12-30T13:21:30.618366877+01:00","dependencies":[{"issue_id":"dogpile-lgg.11","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.61863615+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.12","title":"Scraper: Fundacja Tabby Burasy i Spółka","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.687324088+01:00","updated_at":"2025-12-30T13:21:30.687324088+01:00","dependencies":[{"issue_id":"dogpile-lgg.12","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.687620123+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.13","title":"Scraper: Fundacja Koty na Zakręcie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.755905081+01:00","updated_at":"2025-12-30T13:21:30.755905081+01:00","dependencies":[{"issue_id":"dogpile-lgg.13","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.771019857+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.14","title":"Scraper: Stowarzyszenie Amstaffy Niczyje","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.842941176+01:00","updated_at":"2025-12-30T13:21:30.842941176+01:00","dependencies":[{"issue_id":"dogpile-lgg.14","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.843266206+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.2","title":"Scraper: Schronisko w Wojtyszkach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:29.970321523+01:00","updated_at":"2025-12-30T13:21:29.970321523+01:00","dependencies":[{"issue_id":"dogpile-lgg.2","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:29.970690407+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.3","title":"Scraper: Schronisko Medor w Zgierzu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.045534202+01:00","updated_at":"2025-12-30T13:21:30.045534202+01:00","dependencies":[{"issue_id":"dogpile-lgg.3","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.045995042+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.4","title":"Scraper: Schronisko w Pabianicach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.121436959+01:00","updated_at":"2025-12-30T13:21:30.121436959+01:00","dependencies":[{"issue_id":"dogpile-lgg.4","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.121991728+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.5","title":"Scraper: Przytulisko w Głownie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.200830638+01:00","updated_at":"2025-12-30T13:21:30.200830638+01:00","dependencies":[{"issue_id":"dogpile-lgg.5","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.20223594+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.6","title":"Scraper: Schronisko w Bełchatowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.272866876+01:00","updated_at":"2025-12-30T13:21:30.272866876+01:00","dependencies":[{"issue_id":"dogpile-lgg.6","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.273158673+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.7","title":"Scraper: Schronisko w Tomaszowie Mazowieckim","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.342855566+01:00","updated_at":"2025-12-30T13:21:30.342855566+01:00","dependencies":[{"issue_id":"dogpile-lgg.7","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.343200364+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.8","title":"Scraper: Schronisko w Piotrkowie Trybunalskim","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.412201159+01:00","updated_at":"2025-12-30T13:21:30.412201159+01:00","dependencies":[{"issue_id":"dogpile-lgg.8","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.412471986+01:00","created_by":"daemon"}]}
{"id":"dogpile-lgg.9","title":"Scraper: Schronisko w Czartkach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:30.4803986+01:00","updated_at":"2025-12-30T13:21:30.4803986+01:00","dependencies":[{"issue_id":"dogpile-lgg.9","depends_on_id":"dogpile-lgg","type":"parent-child","created_at":"2025-12-30T13:21:30.480662153+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s","title":"[Małopolskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:27.505885928+01:00","updated_at":"2025-12-30T13:21:27.505885928+01:00","dependencies":[{"issue_id":"dogpile-n1s","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:27.521641757+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.1","title":"Scraper: Schronisko w Krakowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.537583862+01:00","updated_at":"2025-12-30T13:21:27.537583862+01:00","dependencies":[{"issue_id":"dogpile-n1s.1","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.537921106+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.10","title":"Scraper: Schronisko Psie Pole","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.182867684+01:00","updated_at":"2025-12-30T13:21:28.182867684+01:00","dependencies":[{"issue_id":"dogpile-n1s.10","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:28.193386108+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.11","title":"Scraper: Stowarzyszenie Przytul Sierściucha","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.266239435+01:00","updated_at":"2025-12-30T13:21:28.266239435+01:00","dependencies":[{"issue_id":"dogpile-n1s.11","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:28.266580997+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.12","title":"Scraper: Fundacja Lead Group","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.341796592+01:00","updated_at":"2025-12-30T13:21:28.341796592+01:00","dependencies":[{"issue_id":"dogpile-n1s.12","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:28.342390365+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.13","title":"Scraper: Koci Patrol","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.414104068+01:00","updated_at":"2025-12-30T13:21:28.414104068+01:00","dependencies":[{"issue_id":"dogpile-n1s.13","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:28.414455589+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.2","title":"Scraper: Schronisko w Nowym Targu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.60952072+01:00","updated_at":"2025-12-30T13:21:27.60952072+01:00","dependencies":[{"issue_id":"dogpile-n1s.2","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.609846672+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.3","title":"Scraper: Schronisko w Oświęcimiu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.683522799+01:00","updated_at":"2025-12-30T13:21:27.683522799+01:00","dependencies":[{"issue_id":"dogpile-n1s.3","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.683950175+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.4","title":"Scraper: Schronisko w Olkuszu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.754167712+01:00","updated_at":"2025-12-30T13:21:27.754167712+01:00","dependencies":[{"issue_id":"dogpile-n1s.4","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.754484306+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.5","title":"Scraper: Azyl w Tarnowie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.825453958+01:00","updated_at":"2025-12-30T13:21:27.825453958+01:00","dependencies":[{"issue_id":"dogpile-n1s.5","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.825885792+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.6","title":"Scraper: Fundacja La Fauna","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.895474479+01:00","updated_at":"2025-12-30T13:21:27.895474479+01:00","dependencies":[{"issue_id":"dogpile-n1s.6","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.895773639+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.7","title":"Scraper: Fundacja Ostoja Cztery Łapy","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:27.966659581+01:00","updated_at":"2025-12-30T13:21:27.966659581+01:00","dependencies":[{"issue_id":"dogpile-n1s.7","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:27.967028796+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.8","title":"Scraper: Małopolska Org. na Rzecz Natury MORN","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.038771283+01:00","updated_at":"2025-12-30T13:21:28.038771283+01:00","dependencies":[{"issue_id":"dogpile-n1s.8","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:28.039081606+01:00","created_by":"daemon"}]}
{"id":"dogpile-n1s.9","title":"Scraper: Schronisko w Chełmku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:28.111069862+01:00","updated_at":"2025-12-30T13:21:28.111069862+01:00","dependencies":[{"issue_id":"dogpile-n1s.9","depends_on_id":"dogpile-n1s","type":"parent-child","created_at":"2025-12-30T13:21:28.111504591+01:00","created_by":"daemon"}]}
{"id":"dogpile-o1d","title":"[Opolskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:33.415752066+01:00","updated_at":"2025-12-30T13:21:33.415752066+01:00","dependencies":[{"issue_id":"dogpile-o1d","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:33.431854617+01:00","created_by":"daemon"}]}
{"id":"dogpile-o1d.1","title":"Scraper: Schronisko w Opolu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.448940365+01:00","updated_at":"2025-12-30T13:21:33.448940365+01:00","dependencies":[{"issue_id":"dogpile-o1d.1","depends_on_id":"dogpile-o1d","type":"parent-child","created_at":"2025-12-30T13:21:33.449236901+01:00","created_by":"daemon"}]}
{"id":"dogpile-o1d.2","title":"Scraper: Schronisko w Kędzierzynie-Koźlu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.518993839+01:00","updated_at":"2025-12-30T13:21:33.518993839+01:00","dependencies":[{"issue_id":"dogpile-o1d.2","depends_on_id":"dogpile-o1d","type":"parent-child","created_at":"2025-12-30T13:21:33.519311425+01:00","created_by":"daemon"}]}
{"id":"dogpile-o1d.3","title":"Scraper: Schronisko w Nysie","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.58732771+01:00","updated_at":"2025-12-30T13:21:33.58732771+01:00","dependencies":[{"issue_id":"dogpile-o1d.3","depends_on_id":"dogpile-o1d","type":"parent-child","created_at":"2025-12-30T13:21:33.587603487+01:00","created_by":"daemon"}]}
{"id":"dogpile-o1d.4","title":"Scraper: Stowarzyszenie W ogrodzie Viadrusa","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.655946597+01:00","updated_at":"2025-12-30T13:21:33.655946597+01:00","dependencies":[{"issue_id":"dogpile-o1d.4","depends_on_id":"dogpile-o1d","type":"parent-child","created_at":"2025-12-30T13:21:33.656267198+01:00","created_by":"daemon"}]}
{"id":"dogpile-ogp","title":"Define JSON Schemas for structured outputs","description":"Create Effect Schema definitions that generate JSON Schemas for OpenRouter structured outputs.\n\n## CRITICAL: Use structured outputs with strict: true\nDo NOT use prompt-based 'return JSON' - use OpenRouter's response_format parameter:\n```typescript\n{\n  response_format: {\n    type: 'json_schema',\n    json_schema: {\n      name: 'dog_extraction',\n      strict: true,\n      schema: { ... } // Generated from Effect Schema\n    }\n  }\n}\n```\n\n## Schemas to Define\n\n### TextExtractionSchema\nOutput of text analysis - what we extract from shelter description:\n- name, sex, ageEstimate, breedEstimates, sizeEstimate, weightEstimate\n- personalityTags[], healthInfo, compatibility\n- locationHints (foster/shelter, city mentions)\n\n### PhotoExtractionSchema\nOutput of photo analysis - physical traits:\n- breedEstimates, sizeEstimate, ageCategory\n- furLength, furType, colorPrimary, colorSecondary, colorPattern\n- earType, tailType\n\n### DogBioSchema\nOutput of description generation:\n- bio: string (the generated description)\n- tone: 'hopeful' | 'urgent' | 'gentle' (for validation)\n\n## Implementation\n1. Define using Effect Schema (packages/core/src/schemas/)\n2. Create utility to convert Effect Schema -\u003e JSON Schema for OpenRouter\n3. Create runtime decoders for response validation\n4. Ensure all optional fields use Schema.NullOr (strict mode requires explicit nullability)\n\nReference: https://openrouter.ai/docs/guides/features/structured-outputs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:42:12.374722448+01:00","updated_at":"2025-12-28T21:02:48.385249025+01:00","closed_at":"2025-12-28T21:02:48.385249025+01:00","close_reason":"Created Effect Schemas for text/photo extraction and dog bio with JSON Schema utility"}
{"id":"dogpile-pbh","title":"AI-generated dog photos","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-29T13:03:27.748324147+01:00","updated_at":"2025-12-29T17:50:15.434524937+01:00","closed_at":"2025-12-29T17:50:15.434524937+01:00","close_reason":"Fisheye nose photo generation implemented. Uses Gemini image model via OpenRouter. R2 storage integration can be added later."}
{"id":"dogpile-pbh.1","title":"Generate fisheye nose photos using Gemini image model","description":"Use google/gemini-3-pro-image-preview to generate cute fisheye lens close-up nose photos for each dog. Store in dogpile-photos-generated R2 bucket. Add to photos_generated array in DB.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-29T13:03:35.00995819+01:00","updated_at":"2025-12-29T17:49:35.949665156+01:00","closed_at":"2025-12-29T17:49:35.949665156+01:00","close_reason":"Image generation implemented using google/gemini-3-pro-image-preview. CLI flag --generate-photos enables it. R2 upload TODO - currently logs success with base64 size.","dependencies":[{"issue_id":"dogpile-pbh.1","depends_on_id":"dogpile-pbh","type":"parent-child","created_at":"2025-12-29T13:03:35.022012329+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9","title":"[Lifecycle] Dog Availability \u0026 Removal Strategy","description":"Implement robust dog availability tracking with graceful removal based on staleness.\n\n## Problem\nCurrently, if a dog disappears from a shelter's website during a single scrape, it gets marked as 'removed' immediately. This causes false removals when:\n- Shelter website has temporary issues\n- Scraper fails partially\n- Network timeouts on individual dog pages\n\n## Solution\nSwitch from 'absence = removed' to 'stale = removed' using lastSeenAt as a heartbeat with a 36h grace period.\n\n## Architecture\n1. **Circuit Breaker** - Abort sync if \u003e50% dogs disappear (scraper likely broken)\n2. **Heartbeat Updates** - Update lastSeenAt for found dogs, reset status to available\n3. **Graceful Sweep** - Mark dogs as removed only if not seen for 36h (1.5x scrape interval)\n4. **Vectorize Cleanup** - Queue deleted dogs for vector index removal\n5. **UI Handling** - Hide removed dogs from search, show 'no longer available' on direct links\n\n## Status Semantics\n- available: Confirmed on site within 36h\n- removed: No longer listed (could be adopted, transferred, deceased)\n- adopted: Only if explicitly scraped from 'Happy Tails' page\n- reserved: Only if shelter explicitly marks this\n\n## Success Criteria\n- Temporary scraper failure doesn't mass-remove dogs\n- Dogs missing for 2+ consecutive scrapes get marked removed\n- Removed dogs hidden from search but accessible via direct link\n- Vectorize index stays clean (removed dogs deleted from index)","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-30T14:14:09.448411918+01:00","updated_at":"2026-01-04T16:26:10.135125166+01:00","closed_at":"2026-01-04T16:26:10.135125166+01:00","close_reason":"Epic complete: circuit breaker, heartbeat, graceful sweep, vectorize deletion, API filtering, removed dog UI, sync metrics, E2E tests"}
{"id":"dogpile-pg9.1","title":"Add circuit breaker to scraper processor","description":"Add safety check to abort sync when scraper returns suspiciously few results.\n\n## Location\n`apps/scraper-processor/src/index.ts`\n\n## Implementation\nAdd check after fetching rawDogs and existingDogs:\n\n```typescript\nconst MIN_SAFE_COUNT = 10\nconst SAFETY_THRESHOLD = 0.5\n\nif (existingDogs.length \u003e= MIN_SAFE_COUNT \u0026\u0026 \n    rawDogs.length \u003c existingDogs.length * SAFETY_THRESHOLD) {\n  yield* Effect.logError(\n    `Safety Trigger: Scraper found ${rawDogs.length} dogs vs ${existingDogs.length} expected. Aborting sync.`\n  )\n  message.retry() // Retry later, don't ack\n  return\n}\n```\n\n## Logic\n- If existing dogs \u003c 10: Skip check (small shelters have high variance)\n- If new count \u003c 50% of existing: Abort sync\n- Log error for alerting\n- Retry the message instead of acking\n\n## Why\nProtects against:\n- Broken scraper parsing 0 dogs\n- Shelter website returning error page\n- Partial network failures\n\n## Testing\n- Mock scraper returning 2 dogs when DB has 50\n- Verify sync aborts and logs error\n- Verify message is retried, not acked","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:14:24.608569837+01:00","updated_at":"2026-01-04T15:17:21.570204863+01:00","closed_at":"2026-01-04T15:17:21.570204863+01:00","close_reason":"Circuit breaker: warns at 50%, blocks at 30%, logs to syncLogs","dependencies":[{"issue_id":"dogpile-pg9.1","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:14:24.615570631+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9.2","title":"Update heartbeat logic for found dogs","description":"Modify scraper processor to update lastSeenAt and reset status for found dogs.\n\n## Location\n`apps/scraper-processor/src/index.ts`\n\n## Current Behavior\nWhen existing dog is found:\n```typescript\ndb.update(dogs).set({ lastSeenAt: now }).where(eq(dogs.id, existing.id))\n```\n\n## New Behavior\nAlso reset status to 'available' (handles reappearance after removal):\n```typescript\ndb.update(dogs)\n  .set({ \n    lastSeenAt: now,\n    status: 'available'  // Resurrect if previously removed\n  })\n  .where(eq(dogs.id, existing.id))\n```\n\n## Why\n- If a dog was marked 'removed' but reappears on site, it should become available again\n- Shelter might re-list a dog that was temporarily removed\n- This makes the system self-healing\n\n## Edge Cases\n- Dog marked 'adopted' manually should NOT be reset (future consideration)\n- For now, any found dog becomes 'available'\n\n## Testing\n- Insert dog with status='removed' and old lastSeenAt\n- Run scraper that finds this dog\n- Verify status becomes 'available' and lastSeenAt updated","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:14:36.634588348+01:00","updated_at":"2026-01-04T15:17:23.554797597+01:00","closed_at":"2026-01-04T15:17:23.554797597+01:00","close_reason":"Heartbeat: lastSeenAt updated on every scrape, status reset to available if previously removed","dependencies":[{"issue_id":"dogpile-pg9.2","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:14:36.641793184+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9.3","title":"Replace immediate removal with graceful sweep","description":"Replace the current 'mark removed if not in scrape' logic with time-based staleness sweep.\n\n## Location\n`apps/scraper-processor/src/index.ts`\n\n## Current Code (DELETE THIS)\n```typescript\nfor (const existing of existingDogs) {\n  if (!scrapedFingerprints.has(existing.fingerprint)) {\n    db.update(dogs).set({ status: 'removed' }).where(eq(dogs.id, existing.id))\n    reindexJobs.push({ type: 'delete', dogId: existing.id })\n  }\n}\n```\n\n## New Code (REPLACE WITH)\n```typescript\nimport { and, lt, eq, inArray } from 'drizzle-orm'\n\n// Grace period: 36 hours (1.5x daily scrape interval)\nconst GRACE_PERIOD_MS = 36 * 60 * 60 * 1000\nconst sweepCutoff = new Date(Date.now() - GRACE_PERIOD_MS)\n\n// Find stale dogs for this shelter\nconst staleDogs = yield* Effect.tryPromise({\n  try: () =\u003e db.select({ id: dogs.id })\n    .from(dogs)\n    .where(and(\n      eq(dogs.shelterId, job.shelterId),\n      eq(dogs.status, 'available'),\n      lt(dogs.lastSeenAt, sweepCutoff)\n    )),\n  catch: (e) =\u003e new Error(`Failed to fetch stale dogs: ${e}`)\n})\n\nif (staleDogs.length \u003e 0) {\n  // Bulk update status\n  yield* Effect.tryPromise({\n    try: () =\u003e db.update(dogs)\n      .set({ status: 'removed' })\n      .where(inArray(dogs.id, staleDogs.map(d =\u003e d.id))),\n    catch: (e) =\u003e new Error(`Failed to mark stale dogs removed: ${e}`)\n  })\n\n  // Queue for Vectorize deletion\n  staleDogs.forEach(dog =\u003e {\n    reindexJobs.push({ type: 'delete', dogId: dog.id })\n  })\n\n  yield* Effect.logInfo(`Marked ${staleDogs.length} stale dogs as removed`)\n}\n```\n\n## Why 36 Hours\n- Scrapes run daily (~24h interval)\n- 36h = 1.5x interval = exactly one 'free' missed scrape\n- Dog must be missing for 2 consecutive scrapes to be removed\n\n## Key Changes\n- Sweep is scoped to current shelter (shelterId filter)\n- Only touches 'available' dogs (won't re-remove already removed)\n- Uses lastSeenAt timestamp, not presence in current scrape\n- Bulk update for efficiency\n\n## Testing\n- Insert dog with lastSeenAt = 48h ago, status = 'available'\n- Run scraper (dog not in results)\n- Verify dog marked 'removed'\n- Verify reindex job queued with type='delete'","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:15:02.146973575+01:00","updated_at":"2026-01-04T15:41:24.457509496+01:00","closed_at":"2026-01-04T15:41:24.457509496+01:00","close_reason":"Graceful sweep: 36h stale threshold, batched updates (500), batched queue messages (100)","dependencies":[{"issue_id":"dogpile-pg9.3","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:15:02.153072031+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9.4","title":"Handle Vectorize deletion in embedder worker","description":"Ensure embedder worker properly handles 'delete' type reindex jobs.\n\n## Location\n`apps/embedder/src/index.ts`\n\n## Current State\nCheck if embedder already handles delete jobs. If not, implement:\n\n```typescript\ninterface ReindexJob {\n  type: 'upsert' | 'delete'\n  dogId: string\n  description?: string\n}\n\n// In queue handler:\nif (job.type === 'delete') {\n  yield* Effect.tryPromise({\n    try: () =\u003e env.VECTORIZE.deleteByIds([job.dogId]),\n    catch: (e) =\u003e new Error(`Failed to delete from Vectorize: ${e}`)\n  })\n  yield* Effect.logInfo(`Deleted ${job.dogId} from Vectorize`)\n  message.ack()\n  return\n}\n\n// ... existing upsert logic\n```\n\n## Vectorize API\n```typescript\n// Cloudflare Vectorize delete API\nawait env.VECTORIZE.deleteByIds(['dog-id-1', 'dog-id-2'])\n```\n\n## Batch Optimization (Optional)\nIf many deletes come at once, consider batching:\n```typescript\n// Collect delete IDs from batch\nconst deleteIds = batch.messages\n  .filter(m =\u003e m.body.type === 'delete')\n  .map(m =\u003e m.body.dogId)\n\nif (deleteIds.length \u003e 0) {\n  await env.VECTORIZE.deleteByIds(deleteIds)\n  // Ack all delete messages\n}\n```\n\n## Testing\n- Manually queue a delete job\n- Verify vector is removed from Vectorize\n- Query Vectorize to confirm ID no longer exists","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:15:16.50700657+01:00","updated_at":"2026-01-04T15:17:25.004422528+01:00","closed_at":"2026-01-04T15:17:25.004422528+01:00","close_reason":"Vectorize deletion with exponential backoff retry (3 attempts)","dependencies":[{"issue_id":"dogpile-pg9.4","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:15:16.518473112+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9.5","title":"Filter removed dogs from API responses","description":"Ensure API endpoints only return available dogs in listings/search.\n\n## Location\n`apps/api/src/index.ts`\n\n## Endpoints to Update\n\n### GET /dogs (listing)\nAdd status filter:\n```typescript\nconst results = await db.select()\n  .from(dogs)\n  .where(eq(dogs.status, 'available'))  // Add this\n  .limit(limit)\n  .offset(offset)\n```\n\n### GET /dogs/search (when implemented)\nEnsure vector search results are filtered:\n```typescript\n// After getting IDs from Vectorize\nconst dogRecords = await db.select()\n  .from(dogs)\n  .where(and(\n    inArray(dogs.id, vectorIds),\n    eq(dogs.status, 'available')  // Add this\n  ))\n```\n\n### GET /dogs/:id (single dog)\nDo NOT filter here - allow viewing removed dogs with status indicator:\n```typescript\nconst dog = await db.select().from(dogs).where(eq(dogs.id, id))\n// Return dog even if status='removed'\n// Frontend will show appropriate UI\n```\n\n## Response Format\nInclude status in response so frontend can display appropriately:\n```json\n{\n  \"id\": \"...\",\n  \"name\": \"Burek\",\n  \"status\": \"removed\",\n  ...\n}\n```\n\n## Testing\n- Insert dog with status='removed'\n- GET /dogs should NOT include it\n- GET /dogs/:id should return it with status='removed'","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:15:29.517873694+01:00","updated_at":"2026-01-04T15:17:26.9599267+01:00","closed_at":"2026-01-04T15:17:26.9599267+01:00","close_reason":"API filters removed dogs from list/search, adds isRemoved flag to single dog endpoint, supports status=all","dependencies":[{"issue_id":"dogpile-pg9.5","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:15:29.523689999+01:00","created_by":"daemon"}],"comments":[{"id":1,"issue_id":"dogpile-pg9.5","author":"ribelo","text":"UPDATE: Add optional 'includeRemoved' query param to show all dogs.\n\n## Updated API Design\n\n### GET /dogs?includeRemoved=true\n- No flag or includeRemoved=false → only available dogs\n- includeRemoved=true → all dogs including removed\n\n### GET /dogs/search?q=...\u0026includeRemoved=true\nSame pattern - default to available only, flag to include all.\n\n### GET /dogs/:id\nNo change - always returns dog regardless of status (for direct links).\n\n## Use Cases\n- Admin dashboard showing all dogs\n- Analytics/reporting  \n- Debugging","created_at":"2025-12-30T13:20:53Z"}]}
{"id":"dogpile-pg9.6","title":"Show 'no longer available' UI for removed dogs","description":"Update frontend to handle removed dogs on detail pages.\n\n## Location\n`apps/web/src/pages/dogs/[id].astro`\n\n## Current Behavior\n- Redirects to /404 if API returns error\n- No handling for removed status\n\n## New Behavior\nShow the dog page with a prominent banner if status='removed':\n\n```astro\n---\n// ... existing fetch logic\n\nconst dog = await response.json()\nconst isRemoved = dog.status === 'removed'\n---\n\n\u003cLayout title={`${dog.name} - Dogpile`}\u003e\n  {isRemoved \u0026\u0026 (\n    \u003cdiv class=\"bg-sys-state-urgent/20 border-2 border-sys-state-urgent p-6 text-center mb-8\"\u003e\n      \u003cp class=\"text-xl font-bold text-sys-state-urgent\"\u003e\n        Ten pies nie jest już dostępny w schronisku\n      \u003c/p\u003e\n      \u003cp class=\"text-sm opacity-70 mt-2\"\u003e\n        Mógł zostać adoptowany lub przeniesiony do innego schroniska\n      \u003c/p\u003e\n    \u003c/div\u003e\n  )}\n  \n  \u003c!-- Rest of dog details --\u003e\n  \n  {isRemoved ? (\n    \u003ca href=\"/\" class=\"btn-secondary\"\u003e\n      Wróć do wyszukiwania\n    \u003c/a\u003e\n  ) : (\n    \u003ca href={dog.sourceUrl} class=\"btn-primary\"\u003e\n      Skontaktuj się ze schroniskiem\n    \u003c/a\u003e\n  )}\n\u003c/Layout\u003e\n```\n\n## SEO Consideration\nFor dogs removed \u003e 7 days, add noindex:\n```astro\n{isRemoved \u0026\u0026 (\n  \u003cmeta name=\"robots\" content=\"noindex\" slot=\"head\" /\u003e\n)}\n```\n\n## Styling\n- Use existing urgent/warning colors\n- Keep dog photos and info visible (nice memories)\n- Replace 'contact shelter' CTA with 'back to search'\n\n## Testing\n- Access direct link to removed dog\n- Verify banner appears\n- Verify CTA changes\n- Verify page doesn't 404","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:15:46.369300289+01:00","updated_at":"2026-01-04T15:41:25.969816221+01:00","closed_at":"2026-01-04T15:41:25.969816221+01:00","close_reason":"Removed dog UI: banner, dimmed content, hidden contact button","dependencies":[{"issue_id":"dogpile-pg9.6","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:15:46.375860388+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9.7","title":"Add sync metrics and alerting","description":"Track sync metrics to detect scraper issues early.\n\n## Context\nWith graceful removal, we need visibility into sync health to catch issues before the 36h grace period expires.\n\n## Metrics to Track (in syncLogs table)\n\n### Already tracked:\n- dogsAdded\n- dogsUpdated  \n- dogsRemoved\n\n### Add:\n- dogsFound (total in current scrape)\n- dogsExpected (total in DB before scrape)\n- circuitBreakerTriggered (boolean)\n- errors (array of error messages)\n\n## Location\n`apps/scraper-processor/src/index.ts`\n\n## Implementation\n```typescript\n// At end of sync, update log with metrics\nyield* Effect.tryPromise({\n  try: () =\u003e db.update(syncLogs).set({\n    finishedAt: new Date(),\n    dogsAdded: added,\n    dogsRemoved: staleDogs.length,\n    dogsFound: rawDogs.length,\n    dogsExpected: existingDogs.length,\n    // ... other fields\n  }).where(eq(syncLogs.id, syncLogId)),\n  catch: (e) =\u003e new Error(`Failed to update sync log: ${e}`)\n})\n```\n\n## Schema Update (if needed)\n`packages/db/src/schema.ts` - add columns to syncLogs:\n```typescript\ndogsFound: integer('dogs_found'),\ndogsExpected: integer('dogs_expected'),\n```\n\n## Future: Alerting\n- If dogsFound \u003c dogsExpected * 0.7 for 2+ consecutive syncs → alert\n- If circuitBreaker triggered → alert immediately\n- Can implement via Cloudflare notifications or external webhook\n\n## Testing\n- Run sync and check syncLogs table\n- Verify all metrics populated correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:16:02.564572051+01:00","updated_at":"2026-01-04T16:26:06.691826275+01:00","closed_at":"2026-01-04T16:26:06.691826275+01:00","close_reason":"Added /admin/sync-stats endpoint with 24h metrics, success rate, averages, recent errors","dependencies":[{"issue_id":"dogpile-pg9.7","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:16:02.574283519+01:00","created_by":"daemon"}]}
{"id":"dogpile-pg9.8","title":"E2E testing for removal lifecycle","description":"Validate the complete removal lifecycle works correctly.\n\n## Test Scenarios\n\n### 1. Normal Removal Flow\n- Day 1: Dog exists in DB with lastSeenAt = now\n- Day 2: Scraper runs, dog NOT in results, lastSeenAt unchanged\n- Day 2: Sweep runs, dog still available (\u003c 36h stale)\n- Day 3: Scraper runs, dog NOT in results\n- Day 3: Sweep runs, dog marked 'removed' (\u003e 36h stale)\n- Verify: Vectorize delete job queued\n\n### 2. Circuit Breaker Protection\n- DB has 50 dogs for shelter X\n- Scraper returns 5 dogs (broken parser)\n- Verify: Sync aborts, no dogs marked removed\n- Verify: Error logged\n\n### 3. Reappearance\n- Dog marked 'removed' 1 week ago\n- Scraper finds dog again\n- Verify: status reset to 'available'\n- Verify: lastSeenAt updated\n\n### 4. Small Shelter Variance\n- DB has 5 dogs for shelter Y\n- Scraper returns 2 dogs (3 adopted)\n- Verify: Circuit breaker NOT triggered (\u003c 10 threshold)\n- Verify: After 36h, missing 3 dogs marked removed\n\n### 5. API Filtering\n- Mix of available and removed dogs in DB\n- GET /dogs returns only available\n- GET /dogs/:id returns removed dog with status\n\n### 6. UI Display\n- Access removed dog via direct link\n- Verify banner shown\n- Verify CTA changed\n\n## Test Implementation\nAdd test file or CLI command:\n`packages/scrapers/tests/removal-lifecycle.test.ts`\n\n## Acceptance Criteria\n- All 6 scenarios pass\n- No false removals in normal operation\n- Graceful handling of scraper failures","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:16:40.37208537+01:00","updated_at":"2026-01-04T16:26:08.343437875+01:00","closed_at":"2026-01-04T16:26:08.343437875+01:00","close_reason":"E2E tests for circuit breaker, heartbeat, and graceful sweep in lifecycle.test.ts","dependencies":[{"issue_id":"dogpile-pg9.8","depends_on_id":"dogpile-pg9","type":"parent-child","created_at":"2025-12-30T14:16:40.379304479+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99","title":"Frontend implementation based on design system","description":"Implement the Dogpile frontend following the Paper Protocol design system and demo HTML. Current state: basic DogCard/DogGrid exist but need styling refinement. Missing: Hero section, proper layout, filters, dog detail page, footer, animations, and design system polish.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T18:47:38.794493562+01:00","updated_at":"2025-12-29T22:33:40.63309062+01:00","closed_at":"2025-12-29T22:33:40.63309062+01:00","close_reason":"All 9 subtasks completed: Hero, DogCard, CSS, Footer, Detail page, Filters, API wiring, Animations, AI photos. Typecheck passes."}
{"id":"dogpile-q99.1","title":"Implement Hero section with THE PILE IS WAITING header","description":"Create Hero.astro component matching demo: large title 'the pile is waiting', subtitle text, CTA button 'Meet the Dogs', decorative paw prints, gradient background with grain overlay. Use Fraunces font for title, paper textures.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T18:47:48.687217088+01:00","updated_at":"2025-12-29T19:03:04.601536387+01:00","closed_at":"2025-12-29T19:03:04.601536387+01:00","close_reason":"Two-column layout, polaroid image, badge, dog avatar stack, inline SVG icons, animate-breath","dependencies":[{"issue_id":"dogpile-q99.1","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:47:48.698817159+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.2","title":"Polish DogCard component to match design system","description":"Update DogCard.tsx: paper-edge styling, nostalgia-img filter, organic border-radius (rounded-paper), hover lift animation, dashed border footer, proper tag styling (tag-sky, tag-grass), urgent badge styling. Match the demo card layout exactly.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T18:47:57.853017764+01:00","updated_at":"2025-12-29T19:00:36.089120998+01:00","closed_at":"2025-12-29T19:00:36.089120998+01:00","close_reason":"Updated with SVG icons, paper-img border-radius, fixed route to /psy/, added link-arrow class","dependencies":[{"issue_id":"dogpile-q99.2","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:47:57.865106668+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.3","title":"Add global CSS styles for Paper Protocol","description":"Create/update global.css with: paper-edge class (box-shadow for paper depth), nostalgia-img filter (sepia, contrast, brightness), grain overlay texture, rough-edge borders, card base styles. Import Fraunces and Quicksand fonts.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T18:48:13.232076528+01:00","updated_at":"2025-12-29T18:58:58.491497073+01:00","closed_at":"2025-12-29T18:58:58.491497073+01:00","close_reason":"Added boxShadow presets, border-radius variants, grain overlay, badge, polaroid, filter-input, link-arrow classes, and card-grid rotation","dependencies":[{"issue_id":"dogpile-q99.3","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:48:13.242247834+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.4","title":"Implement Footer with mission statement","description":"Create Footer.astro matching demo: dark bg (sys-ink-primary), 'Love is a verb' headline, mission text, animated heart, abstract blob backgrounds, copyright. Use Fraunces for title.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T18:48:22.410743936+01:00","updated_at":"2025-12-29T19:04:52.043372024+01:00","closed_at":"2025-12-29T19:04:52.043372024+01:00","close_reason":"Replaced emoji with SVG heart and paw, updated year to 2025","dependencies":[{"issue_id":"dogpile-q99.4","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:48:22.421751017+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.5","title":"Create dog detail page /psy/[id]","description":"Implement dog detail page showing: large photo gallery (including AI-generated photos), full bio, all extracted data (breed, age, size, personality), health info, compatibility, shelter contact info, 'Say Hello' CTA button. Use paper card styling.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T18:48:32.176958339+01:00","updated_at":"2025-12-29T22:22:41.19604846+01:00","closed_at":"2025-12-29T22:22:41.19604846+01:00","close_reason":"Redesigned with Paper Protocol: polaroid gallery, stats grid with icons, bio blockquote, tag clouds, health badges, Say Hello CTA","dependencies":[{"issue_id":"dogpile-q99.5","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:48:32.183547812+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.6","title":"Add filter/search UI for dog grid","description":"Implement filter UI: size selector (small/medium/large), age range, location/city filter, breed filter, compatibility checkboxes (kids/dogs/cats ok), urgent toggle. Style as paper buttons/dropdowns. Connect to API or client-side filtering.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T18:48:41.993772951+01:00","updated_at":"2025-12-29T22:25:38.037744274+01:00","closed_at":"2025-12-29T22:25:38.037744274+01:00","close_reason":"Created FilterBar.astro with location/size/vibe dropdowns, paper styling, custom select arrow. Integrated into index.astro","dependencies":[{"issue_id":"dogpile-q99.6","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:48:42.005361482+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.7","title":"Wire up API endpoints for frontend","description":"Ensure API worker returns proper data for frontend: GET /dogs with filters, GET /dogs/:id for detail, proper CORS. DogGrid should fetch from API. Handle loading/error states with friendly messages.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T18:48:53.013148155+01:00","updated_at":"2025-12-29T22:28:38.641341524+01:00","closed_at":"2025-12-29T22:28:38.641341524+01:00","close_reason":"DogGrid accepts apiUrl prop, uses createResource with reactive source, adds card-grid class for rotation effect","dependencies":[{"issue_id":"dogpile-q99.7","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:48:53.113174447+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.8","title":"Add animations and micro-interactions","description":"Implement design system animations: breath animation on hero images, wiggle on logo hover, unfold animation on card appear, hover lift on cards, heart icon toggle animation. Add subtle grain overlay to page.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-29T18:49:02.405583261+01:00","updated_at":"2025-12-29T22:30:52.381828819+01:00","closed_at":"2025-12-29T22:30:52.381828819+01:00","close_reason":"Added card stagger animation, heart-pop animation, card-appear class with unfold effect","dependencies":[{"issue_id":"dogpile-q99.8","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:49:02.4232345+01:00","created_by":"daemon"}]}
{"id":"dogpile-q99.9","title":"Display AI-generated fisheye photos","description":"Show photos_generated in dog cards and detail page. Create R2 public URL pattern for generated photos. Maybe show as hover effect or secondary image. Label as 'AI visualization' to be transparent.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T18:49:11.851413486+01:00","updated_at":"2025-12-29T22:32:37.987773821+01:00","closed_at":"2025-12-29T22:32:37.987773821+01:00","close_reason":"Added AI badge to DogCard, hover swap to AI photo, dedicated AI Visualizations section in detail page with fisheye label","dependencies":[{"issue_id":"dogpile-q99.9","depends_on_id":"dogpile-q99","type":"parent-child","created_at":"2025-12-29T18:49:11.863366452+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr","title":"[Frontend] Homepage Redesign \u0026 i18n","description":"Redesign homepage with modern, warm, mobile-first experience and add Polish/English i18n.\n\n## Design Philosophy\n- Modern but not complex\n- Warm 'scrapbook' aesthetic (paper textures, polaroid effects)\n- Subtle micro-animations that enhance, not distract\n- Mobile-first (80% of traffic)\n- Polish default, English secondary\n\n## Page Structure ('Peek' Layout)\n1. **Hero (60-70vh)** - Emotional welcome, polaroid collage, compelling Polish copy\n2. **Search/Filter Bar** - Overlaps hero bottom, becomes sticky on scroll\n3. **Dog Grid** - 2-column mobile, responsive desktop, staggered reveal\n\n## Key Components\n- Compact hero with 'taped polaroid' aesthetic\n- Sticky floating pill filter bar with quick chips\n- Mobile bottom sheet for advanced filters\n- Redesigned dog cards (4:5 aspect, overlay info, animated heart)\n- Skeleton loaders, empty states\n\n## Color Palette\n- Paper base: #fbf8f3\n- Primary (CTA): Orange/Clay #e07a5f  \n- Safe/verified: Sage Green #81b29a\n- Text/contrast: Navy #264653\n\n## Typography\n- Headings: Fraunces (Latin Extended for Polish diacritics)\n- Body: Quicksand\n\n## Animations\n- Staggered card fade-up on scroll\n- Hover lift + slight rotation (paper effect)\n- Elastic heart icon on favorite\n- 'Wag' effect on CTA buttons\n\n## i18n\n- Polish default, English secondary\n- Language switcher in footer/menu (not header)\n- All UI text externalized\n\n## Success Criteria\n- Lighthouse mobile score \u003e 90\n- Time to first dog visible \u003c 2s\n- Works great on iPhone SE to desktop\n- Feels warm and trustworthy","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T15:45:35.342857238+01:00","updated_at":"2025-12-30T15:45:35.342857238+01:00"}
{"id":"dogpile-qdr.1","title":"Setup i18n with Polish default and English","description":"Add internationalization infrastructure with Polish as default language.\n\n## Approach\nUse Astro's built-in i18n or a lightweight solution like paraglide/typesafe-i18n.\n\n## Structure\n```\napps/web/\n├── src/\n│   ├── i18n/\n│   │   ├── pl.json    # Polish translations (default)\n│   │   ├── en.json    # English translations\n│   │   └── index.ts   # i18n utilities\n```\n\n## Polish Translations (examples)\n```json\n{\n  \"hero.headline\": \"Twój nowy najlepszy przyjaciel już tu czeka.\",\n  \"hero.subheadline\": \"Psy z całego kraju w jednym miejscu. Znajdź tego jedynego.\",\n  \"search.placeholder\": \"Szukaj psa...\",\n  \"filters.puppies\": \"Szczeniaki\",\n  \"filters.small\": \"Małe\",\n  \"filters.seniors\": \"Seniorzy\",\n  \"card.years\": \"lat\",\n  \"card.male\": \"Samiec\",\n  \"card.female\": \"Samica\",\n  \"card.urgent\": \"Pilne!\",\n  \"empty.title\": \"Pusto tu...\",\n  \"empty.subtitle\": \"Może spróbuj zmienić kryteria?\",\n  \"empty.showAll\": \"Pokaż wszystkie psy\"\n}\n```\n\n## Language Switcher\n- Simple PL/EN toggle\n- Place in footer or mobile menu\n- Store preference in localStorage\n- Use URL prefix (/en/) or query param\n\n## Implementation\n1. Create translation files\n2. Create useTranslation hook/utility\n3. Replace all hardcoded Polish text with t() calls\n4. Add language switcher component\n\n## Testing\n- Switch to English, verify all text changes\n- Refresh page, verify preference persists\n- Check Polish diacritics render correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:46:33.124381823+01:00","updated_at":"2026-01-04T14:22:02.773880756+01:00","closed_at":"2026-01-04T14:22:02.773880756+01:00","close_reason":"i18n setup complete: apps/web/src/i18n/ with pl.json + en.json, t() helper integrated into Hero, FilterBar, index page","dependencies":[{"issue_id":"dogpile-qdr.1","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:46:33.131568622+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.10","title":"Wire up search/filter to API","description":"Connect FilterBar and FilterDrawer to the search API.\n\n## Dependencies\n- dogpile-bh5.4 (API search endpoint)\n- dogpile-qdr.3 (FilterBar component)\n- dogpile-qdr.4 (FilterDrawer component)\n\n## State Management\n\n### Filter Store\nCreate a SolidJS store for filter state:\n```typescript\n// apps/web/src/stores/filterStore.ts\nimport { createStore } from 'solid-js/store'\n\nexport const [filters, setFilters] = createStore({\n  query: '',\n  size: null as string | null,\n  ageGroup: null as string | null,\n  city: null as string | null,\n  sex: null as string | null,\n  goodWithKids: null as boolean | null,\n  goodWithDogs: null as boolean | null,\n  goodWithCats: null as boolean | null,\n})\n\nexport const clearFilters = () =\u003e setFilters({\n  query: '', size: null, ageGroup: null, city: null,\n  sex: null, goodWithKids: null, goodWithDogs: null, goodWithCats: null\n})\n```\n\n### API Integration\n```typescript\n// apps/web/src/api/dogs.ts\nexport async function searchDogs(filters: Filters): Promise\u003cDog[]\u003e {\n  const params = new URLSearchParams()\n  if (filters.query) params.set('q', filters.query)\n  if (filters.size) params.set('size', filters.size)\n  if (filters.ageGroup) params.set('age', filters.ageGroup)\n  if (filters.city) params.set('city', filters.city)\n  \n  const res = await fetch(`${API_URL}/dogs/search?${params}`)\n  const data = await res.json()\n  return data.dogs\n}\n```\n\n### Reactive Search\n```typescript\n// In DogGrid.tsx\nconst [dogs] = createResource(\n  () =\u003e filters,  // Track filter changes\n  searchDogs,\n  { initialValue: [] }\n)\n```\n\n## Debouncing\n- Query input: 300ms debounce\n- Chip/filter clicks: immediate\n\n## URL State\n- Sync filters to URL params for shareability\n- On page load, read filters from URL\n\n## Testing\n- Type in search, verify API called after 300ms\n- Click chip, verify immediate filter\n- Share URL with filters, verify persisted","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:54:28.02658979+01:00","updated_at":"2026-01-04T14:57:52.815397381+01:00","closed_at":"2026-01-04T14:57:52.815397381+01:00","close_reason":"Wired FilterBar to API with city/size/sex filters, event-based island communication, validated params","dependencies":[{"issue_id":"dogpile-qdr.10","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:54:28.033921997+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.11","title":"Add footer with language switcher","description":"Create footer component with language toggle and site info.\n\n## Location\n`apps/web/src/components/Footer.astro`\n\n## Content\n\n### Column 1: About\n- Brief description of dogpile\n- 'Agregator ogłoszeń adopcyjnych z całej Polski'\n\n### Column 2: Links\n- O nas (About)\n- Kontakt (Contact)  \n- Dla schronisk (For Shelters)\n\n### Column 3: Language\n- Simple toggle: PL / EN\n- Current language highlighted\n\n### Bottom Bar\n- Copyright\n- 'Ostatnia aktualizacja: 2h temu' (trust signal)\n\n## Design\n- Background: sys-navy (#264653) for contrast\n- Text: white/cream\n- Paper texture subtle overlay\n- Border-top with torn paper effect\n\n## Language Switcher Implementation\n```tsx\nfunction LanguageSwitcher() {\n  const [lang, setLang] = createSignal(\n    localStorage.getItem('lang') || 'pl'\n  )\n  \n  const toggle = (newLang: string) =\u003e {\n    localStorage.setItem('lang', newLang)\n    setLang(newLang)\n    // Trigger i18n reload\n  }\n  \n  return (\n    \u003cdiv class=\"flex gap-2\"\u003e\n      \u003cbutton \n        class={lang() === 'pl' ? 'font-bold' : 'opacity-60'}\n        onClick={() =\u003e toggle('pl')}\n      \u003e\n        PL\n      \u003c/button\u003e\n      \u003cspan class=\"opacity-40\"\u003e|\u003c/span\u003e\n      \u003cbutton\n        class={lang() === 'en' ? 'font-bold' : 'opacity-60'}\n        onClick={() =\u003e toggle('en')}\n      \u003e\n        EN\n      \u003c/button\u003e\n    \u003c/div\u003e\n  )\n}\n```\n\n## Mobile\n- Stack columns vertically\n- Language switcher prominent\n- Reduce padding","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:54:43.54063173+01:00","updated_at":"2026-01-04T14:22:08.996728018+01:00","closed_at":"2026-01-04T14:22:08.996728018+01:00","close_reason":"Footer.astro with LanguageSwitcher.tsx component implemented","dependencies":[{"issue_id":"dogpile-qdr.11","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:54:43.547799244+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.12","title":"Mobile responsiveness audit and fixes","description":"Ensure entire site works perfectly on mobile devices.\n\n## Test Devices\n- iPhone SE (375px) - smallest common\n- iPhone 14 (390px) - common\n- Pixel 7 (412px)\n- iPad Mini (768px) - tablet\n\n## Checklist\n\n### Hero\n- [ ] Text readable, not cramped\n- [ ] Polaroids stack nicely\n- [ ] Search bar visible above fold\n\n### Filter Bar\n- [ ] Chips horizontally scrollable\n- [ ] Touch targets 44px+\n- [ ] Glassmorphism doesn't obscure content\n\n### Dog Grid\n- [ ] 2-column layout on mobile\n- [ ] Cards fit without horizontal scroll\n- [ ] Images load fast\n\n### Dog Cards\n- [ ] Heart button easy to tap\n- [ ] Text legible over image gradient\n- [ ] No text truncation issues\n\n### Filter Drawer\n- [ ] Opens smoothly from bottom\n- [ ] Easy to close (drag or tap backdrop)\n- [ ] All options reachable\n\n### Dog Detail Page\n- [ ] Image slider works with swipe\n- [ ] CTA button thumb-reachable\n- [ ] Stats grid doesn't overflow\n\n### Footer\n- [ ] Links tappable\n- [ ] Language switcher visible\n\n## Common Issues to Fix\n- Horizontal overflow causing scroll\n- Text too small (\u003c 16px)\n- Touch targets too small\n- Fixed elements covering content\n- Viewport height issues (100vh bug)\n\n## Testing\n- Use Chrome DevTools device mode\n- Test on real devices if possible\n- Check both portrait and landscape","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T15:54:57.942318824+01:00","updated_at":"2025-12-30T15:54:57.942318824+01:00","dependencies":[{"issue_id":"dogpile-qdr.12","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:54:57.954021582+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.2","title":"Redesign hero section with polaroid aesthetic","description":"Create compact, emotional hero with scrapbook/polaroid design.\n\n## Location\n`apps/web/src/components/Hero.astro`\n\n## Design Specs\n\n### Layout\n- Height: 60-70vh max (shows search bar above fold)\n- Background: Curved/convex bottom edge pointing to content\n\n### Polaroid Collage\n- Desktop: 3 overlapping polaroid frames with dog photos\n- Mobile: Single stacked pile, top photo tilts on scroll\n- 'Taped' effect on corners (CSS pseudo-elements like washi tape)\n- Slight rotation on each frame (-3deg, 2deg, -1deg)\n\n### Copy (Polish)\n```\nHeadline: \"Twój nowy najlepszy przyjaciel już tu czeka.\"\nSubheadline: \"Psy z całego kraju w jednym miejscu. Znajdź tego jedynego.\"\n```\n\n### Trust Signal\n- Ticker: \"12 psów znalazło dom dzisiaj\" (animated count)\n\n## CSS Classes Needed\n```css\n.polaroid {\n  background: white;\n  padding: 1rem 1rem 3rem;\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n  transform: rotate(var(--rotation));\n}\n\n.tape-effect::before {\n  content: '';\n  position: absolute;\n  /* washi tape styling */\n}\n\n.hero-curve {\n  clip-path: ellipse(150% 100% at 50% 0%);\n}\n```\n\n## Animations\n- Subtle Ken Burns drift on photos (slow zoom/pan)\n- Polaroids slightly shift on scroll (parallax)\n\n## Mobile\n- Stack polaroids vertically with overlap\n- Reduce text size\n- Ensure CTA visible above fold","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T15:47:37.38402974+01:00","updated_at":"2025-12-30T15:47:37.38402974+01:00","dependencies":[{"issue_id":"dogpile-qdr.2","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:47:37.396073928+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.3","title":"Create sticky floating filter bar","description":"Build the main search/filter bar with sticky behavior and quick chips.\n\n## Location\n`apps/web/src/components/FilterBar.tsx` (SolidJS for interactivity)\n\n## Design Specs\n\n### Appearance\n- Floating pill shape with rounded corners\n- Glassmorphism: translucent white + backdrop-blur(8px)\n- Subtle shadow for depth\n- Overlaps hero bottom initially (negative margin)\n\n### Sticky Behavior\n- Normal position: overlapping hero bottom\n- On scroll past hero: sticks to top (position: sticky)\n- Smooth transition, no jarring jump\n\n### Content\n1. **Search Input** - left side, icon + placeholder\n2. **Quick Chips** - horizontal scroll on mobile\n   - Szczeniaki (Puppies)\n   - Małe (Small)\n   - Średnie (Medium)\n   - Duże (Large)\n   - Seniorzy (Seniors)\n3. **Filter Button** - right side, opens bottom sheet\n\n### Mobile Layout\n```\n[🔍 Szukaj...        ] [⚙️]\n[Szczeniaki][Małe][Średnie][Duże]...\n```\n- Chips horizontally scrollable\n- Filter button opens drawer\n\n### Desktop Layout\n```\n[🔍 Szukaj psa...] [Szczeniaki][Małe][Średnie][Duże][Seniorzy] [Więcej filtrów]\n```\n\n## State Management\n- Selected chips highlighted\n- Search input debounced (300ms)\n- Emit filter changes to parent/store\n\n## CSS\n```css\n.filter-bar {\n  background: rgba(255, 255, 255, 0.8);\n  backdrop-filter: blur(8px);\n  border-radius: 9999px;\n  position: sticky;\n  top: 1rem;\n  z-index: 40;\n}\n\n.chip {\n  @apply px-4 py-2 rounded-full text-sm font-medium;\n  @apply bg-white/50 hover:bg-white transition;\n}\n\n.chip.active {\n  @apply bg-sys-nature-clay text-white;\n}\n```","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T15:48:38.671820838+01:00","updated_at":"2025-12-30T15:48:38.671820838+01:00","dependencies":[{"issue_id":"dogpile-qdr.3","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:48:38.679270107+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.4","title":"Build mobile filter bottom sheet","description":"Create bottom drawer for advanced filters on mobile.\n\n## Location\n`apps/web/src/components/FilterDrawer.tsx`\n\n## Trigger\n- Filter button (⚙️) in FilterBar\n- 'Więcej filtrów' on desktop\n\n## Design Specs\n\n### Bottom Sheet Behavior\n- Slides up from bottom\n- Covers ~70% of screen\n- Backdrop overlay (click to close)\n- Drag handle at top\n- Smooth spring animation\n\n### Filter Options\n1. **Lokalizacja (Location)**\n   - City/region selector or text input\n   \n2. **Wiek (Age)**\n   - Szczeniak (\u003c 1 rok)\n   - Dorosły (1-7 lat)\n   - Senior (\u003e 7 lat)\n   \n3. **Wielkość (Size)**\n   - Mały\n   - Średni\n   - Duży\n   \n4. **Płeć (Sex)**\n   - Pies (Male)\n   - Suczka (Female)\n   \n5. **Zgodność (Compatibility)**\n   - Z dziećmi\n   - Z psami\n   - Z kotami\n\n### Actions\n- 'Wyczyść filtry' (Clear) - text button\n- 'Pokaż X psów' (Show X dogs) - primary button with count\n\n## Animation\n```css\n.drawer-enter {\n  transform: translateY(100%);\n}\n.drawer-enter-active {\n  transform: translateY(0);\n  transition: transform 300ms cubic-bezier(0.32, 0.72, 0, 1);\n}\n```\n\n## Accessibility\n- Focus trap when open\n- Escape key closes\n- aria-modal='true'\n\n## State\n- Sync with FilterBar state\n- Preview count updates as filters change","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:49:42.306160945+01:00","updated_at":"2026-01-04T14:22:04.171377613+01:00","closed_at":"2026-01-04T14:22:04.171377613+01:00","close_reason":"MobileFilterSheet.tsx implemented with animations, Portal, focus trap, and swipe-to-close","dependencies":[{"issue_id":"dogpile-qdr.4","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:49:42.314598378+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.5","title":"Redesign dog cards with overlay info","description":"Update DogCard component with new visual design.\n\n## Location\n`apps/web/src/components/DogCard.tsx`\n\n## Design Specs\n\n### Image\n- Aspect ratio: 4:5 (portrait, shows full dog)\n- Object-fit: cover, face centered\n- Gradient overlay at bottom (for text legibility)\n\n### Info Overlay (on image)\n- Position: bottom of image\n- Name: Bold, white, Fraunces font, text-shadow\n- Pills: Age + Sex (e.g., '2 lata • Samiec')\n\n### Below Image\n- Shelter/City name only (muted text)\n- Minimal - let the face speak\n\n### Heart/Favorite Button\n- Position: top-right corner of image\n- Size: 44x44px minimum (touch target)\n- Animation: elastic scale on click (1.0 → 1.3 → 1.0)\n\n### Urgent Badge\n- 'Pilne!' sticker on top-left\n- Rotated -5deg (looks hand-placed)\n- Red/orange background\n\n### Hover Effects (Desktop)\n- translateY(-4px) lift\n- rotate(1deg) subtle tilt\n- Shadow grows\n- Transition: 200ms ease-out\n\n## Mobile Grid\n- 2 columns, 0.5rem gap\n- Cards fill width equally\n\n## Markup Structure\n```tsx\n\u003carticle class=\"dog-card group\"\u003e\n  \u003cdiv class=\"relative\"\u003e\n    \u003cimg src={photo} class=\"aspect-[4/5] object-cover\" /\u003e\n    \u003cdiv class=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\" /\u003e\n    \n    {urgent \u0026\u0026 \u003cspan class=\"urgent-badge\"\u003ePilne!\u003c/span\u003e}\n    \u003cbutton class=\"heart-btn\"\u003e{favorited ? '❤️' : '🤍'}\u003c/button\u003e\n    \n    \u003cdiv class=\"absolute bottom-0 p-4 text-white\"\u003e\n      \u003ch3 class=\"font-title text-xl font-bold\"\u003e{name}\u003c/h3\u003e\n      \u003cdiv class=\"flex gap-2 text-sm opacity-80\"\u003e\n        \u003cspan\u003e{age} lat\u003c/span\u003e\n        \u003cspan\u003e•\u003c/span\u003e\n        \u003cspan\u003e{sex}\u003c/span\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \u003cdiv class=\"p-2 text-sm text-muted\"\u003e\n    {shelter} • {city}\n  \u003c/div\u003e\n\u003c/article\u003e\n```","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T15:50:47.822290717+01:00","updated_at":"2025-12-30T15:50:47.822290717+01:00","dependencies":[{"issue_id":"dogpile-qdr.5","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:50:47.827546717+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.6","title":"Implement staggered card reveal animation","description":"Add scroll-triggered staggered fade-up animation for dog cards.\n\n## Location\n`apps/web/src/components/DogGrid.tsx`\n\n## Animation Spec\n- Cards start: opacity-0, translateY(16px)\n- Cards end: opacity-100, translateY(0)\n- Stagger: 50ms delay per card in viewport batch\n- Trigger: when card enters viewport (IntersectionObserver)\n\n## Implementation Options\n\n### Option A: CSS + IntersectionObserver\n```tsx\n// In DogGrid.tsx\nimport { onMount, For, createSignal } from 'solid-js'\n\nexport default function DogGrid(props) {\n  let gridRef: HTMLDivElement\n  \n  onMount(() =\u003e {\n    const observer = new IntersectionObserver(\n      (entries) =\u003e {\n        entries.forEach((entry, i) =\u003e {\n          if (entry.isIntersecting) {\n            const card = entry.target as HTMLElement\n            card.style.transitionDelay = `${i * 50}ms`\n            card.classList.add('revealed')\n            observer.unobserve(card)\n          }\n        })\n      },\n      { threshold: 0.1 }\n    )\n    \n    gridRef.querySelectorAll('.dog-card').forEach(card =\u003e {\n      observer.observe(card)\n    })\n  })\n  \n  return (\n    \u003cdiv ref={gridRef} class=\"grid ...\"\u003e\n      \u003cFor each={dogs()}\u003e\n        {(dog) =\u003e \u003cDogCard class=\"dog-card opacity-0 translate-y-4\" dog={dog} /\u003e}\n      \u003c/For\u003e\n    \u003c/div\u003e\n  )\n}\n```\n\n### CSS\n```css\n.dog-card {\n  opacity: 0;\n  transform: translateY(16px);\n  transition: opacity 400ms ease-out, transform 400ms ease-out;\n}\n\n.dog-card.revealed {\n  opacity: 1;\n  transform: translateY(0);\n}\n```\n\n### Option B: Use motion library (if needed)\n- solid-motionone or similar\n- More control, but adds bundle size\n\n## Considerations\n- Don't animate on initial page load if cards visible\n- Reset animation on filter change (new results)\n- Respect prefers-reduced-motion\n\n## Testing\n- Scroll down slowly, see cards fade up sequentially\n- Filter, new cards animate in\n- Check performance on mobile (no jank)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:51:54.655621422+01:00","updated_at":"2026-01-04T14:22:05.590351369+01:00","closed_at":"2026-01-04T14:22:05.590351369+01:00","close_reason":"Staggered card reveal implemented via card-appear class and animation in CSS","dependencies":[{"issue_id":"dogpile-qdr.6","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:51:54.66249832+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.7","title":"Add skeleton loaders and empty states","description":"Create loading and empty state UI for better perceived performance.\n\n## Skeleton Loader\n\n### Location\n`apps/web/src/components/DogCardSkeleton.tsx`\n\n### Design\n- Matches DogCard shape exactly\n- Shimmer animation (pencil shading effect)\n- Show 6-8 skeletons while loading\n\n### Implementation\n```tsx\nexport function DogCardSkeleton() {\n  return (\n    \u003cdiv class=\"dog-card animate-pulse\"\u003e\n      \u003cdiv class=\"aspect-[4/5] bg-sys-paper-shadow/30 rounded-t-lg\" /\u003e\n      \u003cdiv class=\"p-4 space-y-2\"\u003e\n        \u003cdiv class=\"h-4 bg-sys-paper-shadow/30 rounded w-2/3\" /\u003e\n        \u003cdiv class=\"h-3 bg-sys-paper-shadow/20 rounded w-1/2\" /\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  )\n}\n```\n\n### Shimmer Effect\n```css\n@keyframes shimmer {\n  0% { background-position: -200% 0; }\n  100% { background-position: 200% 0; }\n}\n\n.skeleton-shimmer {\n  background: linear-gradient(\n    90deg,\n    rgba(0,0,0,0.05) 0%,\n    rgba(0,0,0,0.1) 50%,\n    rgba(0,0,0,0.05) 100%\n  );\n  background-size: 200% 100%;\n  animation: shimmer 1.5s infinite;\n}\n```\n\n## Empty State\n\n### Location\n`apps/web/src/components/EmptyState.tsx`\n\n### Design\n- Illustration: empty dog house or sleeping dog\n- Headline: 'Pusto tu...'\n- Subtext: 'Może spróbuj zmienić kryteria?'\n- CTA: 'Pokaż wszystkie psy' button\n\n### Implementation\n```tsx\nexport function EmptyState({ onReset }: { onReset: () =\u003e void }) {\n  return (\n    \u003cdiv class=\"text-center py-16\"\u003e\n      \u003cimg src=\"/images/empty-doghouse.svg\" class=\"w-48 mx-auto mb-6 opacity-60\" /\u003e\n      \u003ch3 class=\"font-title text-2xl mb-2\"\u003ePusto tu...\u003c/h3\u003e\n      \u003cp class=\"text-sys-ink-secondary mb-6\"\u003e\n        Może spróbuj zmienić kryteria?\n      \u003c/p\u003e\n      \u003cbutton onClick={onReset} class=\"btn-primary\"\u003e\n        Pokaż wszystkie psy\n      \u003c/button\u003e\n    \u003c/div\u003e\n  )\n}\n```\n\n## Integration\nIn DogGrid:\n```tsx\n\u003cShow when={dogs.loading}\u003e\n  \u003cFor each={Array(8)}\u003e{() =\u003e \u003cDogCardSkeleton /\u003e}\u003c/For\u003e\n\u003c/Show\u003e\n\n\u003cShow when={!dogs.loading \u0026\u0026 dogs()?.length === 0}\u003e\n  \u003cEmptyState onReset={clearFilters} /\u003e\n\u003c/Show\u003e\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:53:01.674437247+01:00","updated_at":"2026-01-04T14:22:06.727948371+01:00","closed_at":"2026-01-04T14:22:06.727948371+01:00","close_reason":"SkeletonCard and EmptyState components implemented in DogGrid.tsx","dependencies":[{"issue_id":"dogpile-qdr.7","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:53:01.694327814+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.8","title":"Update Tailwind config with design tokens","description":"Ensure Tailwind config has all design tokens from the new design system.\n\n## Location\n`apps/web/tailwind.config.mjs`\n\n## Color Palette\n```js\ncolors: {\n  sys: {\n    paper: {\n      base: '#fbf8f3',      // Main background\n      card: '#ffffff',\n      shadow: '#e8e4de',\n    },\n    ink: {\n      primary: '#2d2a26',\n      secondary: '#6b6560',\n      muted: '#9a958f',\n    },\n    nature: {\n      clay: '#e07a5f',      // Primary CTA\n      grass: '#81b29a',     // Success/verified\n      sky: '#a8dadc',       // Info\n    },\n    state: {\n      urgent: '#e63946',    // Urgent badge\n    },\n    navy: '#264653',        // Footer, contrast\n  }\n}\n```\n\n## Typography\n```js\nfontFamily: {\n  title: ['Fraunces', 'serif'],\n  body: ['Quicksand', 'sans-serif'],\n  narrative: ['Quicksand', 'sans-serif'],\n}\n```\n\n## Ensure Google Fonts Include\n- Fraunces: Latin Extended subset (for ą, ę, ś, ć, ź, ż, ł, ń, ó)\n- Quicksand: Latin Extended\n\n## Custom Utilities\n```js\n// In plugins or utilities\n'.paper-edge': {\n  'box-shadow': '2px 2px 0 var(--tw-shadow-color, #e8e4de)',\n  'border': '1px solid #e8e4de',\n}\n\n'.glassmorphism': {\n  'background': 'rgba(255, 255, 255, 0.8)',\n  'backdrop-filter': 'blur(8px)',\n}\n```\n\n## Testing\n- Verify all color tokens work in components\n- Check Polish diacritics render in Fraunces\n- Test glassmorphism on various backgrounds","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:53:55.304829675+01:00","updated_at":"2026-01-04T14:22:07.854995639+01:00","closed_at":"2026-01-04T14:22:07.854995639+01:00","close_reason":"Tailwind config updated with Paper Protocol design tokens (commit ab835f8)","dependencies":[{"issue_id":"dogpile-qdr.8","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:53:55.317836279+01:00","created_by":"daemon"}]}
{"id":"dogpile-qdr.9","title":"Optimize images for performance","description":"Ensure dog photos are optimized for fast loading.\n\n## Goals\n- Lighthouse mobile score \u003e 90\n- First dog visible \u003c 2s\n- No layout shift from images\n\n## Image Requirements\n\n### Card Images\n- Format: WebP with AVIF fallback\n- Size: 400px width for mobile, 600px for desktop\n- Aspect ratio: 4:5 (set in CSS, not intrinsic)\n- Lazy loading for below-fold images\n\n### Hero Images\n- Preload above-fold hero images\n- Use srcset for responsive sizing\n\n## Implementation\n\n### 1. Astro Image Component\n```astro\n---\nimport { Image } from 'astro:assets'\n---\n\u003cImage \n  src={dog.photos[0]} \n  alt={dog.name}\n  width={400}\n  height={500}\n  format=\"webp\"\n  loading=\"lazy\"\n  decoding=\"async\"\n/\u003e\n```\n\n### 2. Cloudflare Image Resizing\nIf using R2/Cloudflare:\n```\nhttps://your-r2-domain.com/cdn-cgi/image/width=400,format=auto/{photo-key}\n```\n\n### 3. Placeholder/LQIP\n- Generate blur placeholder for each image\n- Show while loading\n- Prevents layout shift\n\n### 4. Preconnect\n```html\n\u003clink rel=\"preconnect\" href=\"https://your-r2-domain.com\" /\u003e\n```\n\n## Testing\n- Run Lighthouse on mobile\n- Check 'Largest Contentful Paint'\n- Verify no Cumulative Layout Shift from images\n- Test on slow 3G throttling","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T15:54:10.107217903+01:00","updated_at":"2025-12-30T15:54:10.107217903+01:00","dependencies":[{"issue_id":"dogpile-qdr.9","depends_on_id":"dogpile-qdr","type":"parent-child","created_at":"2025-12-30T15:54:10.185850809+01:00","created_by":"daemon"}]}
{"id":"dogpile-qv7","title":"Create Cloudflare resources and configure wrangler","description":"Create all required Cloudflare resources for dogpile.extropy.club:\n\n## Resources to Create\n- D1 database: dogpile-db\n- KV namespace: dogpile-cache\n- R2 bucket: dogpile-photos-original\n- R2 bucket: dogpile-photos-generated\n- Vectorize index: dogpile-dogs\n- Queues: dogpile-scrape-jobs, dogpile-reindex-jobs\n\n## Domain Setup\n- Domain: extropy.club (already owned)\n- Subdomain: dogpile.extropy.club\n- Configure DNS and SSL\n\n## Steps\n1. Create resources via wrangler CLI or dashboard\n2. Update all wrangler.toml files with actual resource IDs\n3. Configure custom domain for web worker\n4. Set up OPENROUTER_API_KEY secret: `wrangler secret put OPENROUTER_API_KEY`\n5. Run initial D1 migrations\n\n## Wrangler Commands\n```bash\nwrangler d1 create dogpile-db\nwrangler kv:namespace create dogpile-cache\nwrangler r2 bucket create dogpile-photos-original\nwrangler r2 bucket create dogpile-photos-generated\nwrangler vectorize create dogpile-dogs --dimensions 768 --metric cosine\nwrangler queues create dogpile-scrape-jobs\nwrangler queues create dogpile-reindex-jobs\n```","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-28T20:33:32.59430306+01:00","updated_at":"2025-12-29T10:57:37.58768658+01:00","closed_at":"2025-12-29T10:57:37.58768658+01:00","close_reason":"Created all CF resources and applied D1 migrations","dependencies":[{"issue_id":"dogpile-qv7","depends_on_id":"dogpile-47n","type":"blocks","created_at":"2025-12-28T20:33:47.851928654+01:00","created_by":"daemon"}]}
{"id":"dogpile-rrc","title":"[Lubuskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:33.151270505+01:00","updated_at":"2025-12-30T13:21:33.151270505+01:00","dependencies":[{"issue_id":"dogpile-rrc","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:33.166822104+01:00","created_by":"daemon"}]}
{"id":"dogpile-rrc.1","title":"Scraper: Schronisko w Zielonej Górze","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.194582775+01:00","updated_at":"2025-12-30T13:21:33.194582775+01:00","dependencies":[{"issue_id":"dogpile-rrc.1","depends_on_id":"dogpile-rrc","type":"parent-child","created_at":"2025-12-30T13:21:33.200033297+01:00","created_by":"daemon"}]}
{"id":"dogpile-rrc.2","title":"Scraper: Schronisko Azorki w Gorzowie Wlkp.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.274357842+01:00","updated_at":"2025-12-30T13:21:33.274357842+01:00","dependencies":[{"issue_id":"dogpile-rrc.2","depends_on_id":"dogpile-rrc","type":"parent-child","created_at":"2025-12-30T13:21:33.274662473+01:00","created_by":"daemon"}]}
{"id":"dogpile-rrc.3","title":"Scraper: Schronisko w Żarach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.346816466+01:00","updated_at":"2025-12-30T13:21:33.346816466+01:00","dependencies":[{"issue_id":"dogpile-rrc.3","depends_on_id":"dogpile-rrc","type":"parent-child","created_at":"2025-12-30T13:21:33.34711749+01:00","created_by":"daemon"}]}
{"id":"dogpile-s01","title":"Build dog listing and detail pages","description":"Complete the web frontend:\n\n1. Dog listing page with filters:\n   - City/distance sorting\n   - Size, breed, age filters\n   - Urgent flag filter\n   - Infinite scroll or pagination\n\n2. Dog detail page:\n   - Full photo gallery\n   - All extracted data displayed\n   - Breed confidence bars\n   - Compatibility badges\n   - Link to shelter/source","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-28T20:34:12.203833526+01:00","updated_at":"2025-12-29T00:15:00.636796818+01:00","closed_at":"2025-12-29T00:15:00.636796818+01:00","close_reason":"Created Astro pages for dog listing and detail views"}
{"id":"dogpile-sam","title":"[Świętokrzyskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:33.724608936+01:00","updated_at":"2025-12-30T13:21:33.724608936+01:00","dependencies":[{"issue_id":"dogpile-sam","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:33.739845333+01:00","created_by":"daemon"}]}
{"id":"dogpile-sam.1","title":"Scraper: Schronisko w Dyminach","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.756557608+01:00","updated_at":"2025-12-30T13:21:33.756557608+01:00","dependencies":[{"issue_id":"dogpile-sam.1","depends_on_id":"dogpile-sam","type":"parent-child","created_at":"2025-12-30T13:21:33.756826371+01:00","created_by":"daemon"}]}
{"id":"dogpile-u1d","title":"Create AI configuration system","description":"Create configuration system for AI models using Effect.Config.\n\n## Environment Variables\n```\nOPENROUTER_API_KEY=sk-...                           # Required, secret\n\n# Models (all with reasoning enabled where supported)\nMODEL_TEXT_EXTRACTION=x-ai/grok-4.1-fast            # Extract data from shelter text\nMODEL_PHOTO_ANALYSIS=google/gemini-3-flash-preview  # Analyze dog photos  \nMODEL_DESCRIPTION_GEN=google/gemini-3-flash-preview # Generate dog bios\nMODEL_EMBEDDING=google/gemini-embedding-001         # Vector embeddings\n```\n\n## Implementation\n1. Create AIConfig type with all model settings\n2. Use Effect.Config with defaults for each model\n3. Create .env.example with all variables documented\n4. Update all wrangler.toml files with [vars] defaults\n5. Document how to set secrets via 'wrangler secret put'\n\n## Effect Pattern\n```typescript\nexport const AIConfig = Config.all({\n  apiKey: Config.redacted('OPENROUTER_API_KEY'),\n  textExtractionModel: Config.string('MODEL_TEXT_EXTRACTION').pipe(\n    Config.withDefault('x-ai/grok-4.1-fast')\n  ),\n  photoAnalysisModel: Config.string('MODEL_PHOTO_ANALYSIS').pipe(\n    Config.withDefault('google/gemini-3-flash-preview')\n  ),\n  descriptionGenModel: Config.string('MODEL_DESCRIPTION_GEN').pipe(\n    Config.withDefault('google/gemini-3-flash-preview')\n  ),\n  embeddingModel: Config.string('MODEL_EMBEDDING').pipe(\n    Config.withDefault('google/gemini-embedding-001')\n  ),\n})\n```\n\n## Reasoning Mode\nFor models that support it, enable reasoning in the request:\n```typescript\n{\n  model: 'google/gemini-3-flash-preview',\n  reasoning: { effort: 'medium' }  // or as per OpenRouter docs\n}\n```\n\nLocation: packages/core/src/config/ai.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:41:54.125348984+01:00","updated_at":"2025-12-28T21:00:46.214966217+01:00","closed_at":"2025-12-28T21:00:46.214966217+01:00","close_reason":"Created AIConfig with model configuration using Effect.Config"}
{"id":"dogpile-we6","title":"Implement PhotoAnalyzer service","description":"Create PhotoAnalyzer Effect service for extracting physical traits from dog photos.\n\n## Depends on\n- OpenRouterClient (dogpile-czv)\n- JSON Schemas (dogpile-ogp)\n- AI Config (dogpile-u1d)\n\n## Interface\n```typescript\ninterface PhotoAnalyzer {\n  analyze: (photoUrls: readonly string[]) =\u003e Effect\u003cPhotoExtractionResult, ExtractionError\u003e\n  analyzeSingle: (photoUrl: string) =\u003e Effect\u003cPhotoExtractionResult, ExtractionError\u003e\n}\n```\n\n## Implementation\n1. Use OpenRouterClient.responses() with MODEL_PHOTO_ANALYSIS\n2. Pass images via URL (OpenRouter/Gemini support image URLs directly)\n3. If multiple photos, analyze best one or merge results\n4. response_format: { type: 'json_schema', json_schema: PhotoExtractionSchema }\n5. Validate with Effect Schema decoder\n\n## Considerations\n- Prefer image URLs over base64 (token efficiency)\n- If shelter images are not public, may need to proxy through R2\n- Handle poor quality / multiple dogs in photo gracefully\n- Extract confidence levels for breed estimates\n\nLocation: packages/core/src/services/ai/photo-analyzer.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:42:38.325125066+01:00","updated_at":"2025-12-28T21:07:22.980856666+01:00","closed_at":"2025-12-28T21:07:22.980856666+01:00","close_reason":"Implemented PhotoAnalyzer with image input support","dependencies":[{"issue_id":"dogpile-we6","depends_on_id":"dogpile-czv","type":"blocks","created_at":"2025-12-28T20:43:21.92676925+01:00","created_by":"daemon"},{"issue_id":"dogpile-we6","depends_on_id":"dogpile-u1d","type":"blocks","created_at":"2025-12-28T20:43:21.941276945+01:00","created_by":"daemon"},{"issue_id":"dogpile-we6","depends_on_id":"dogpile-ogp","type":"blocks","created_at":"2025-12-28T20:43:21.955347476+01:00","created_by":"daemon"},{"issue_id":"dogpile-we6","depends_on_id":"dogpile-ada","type":"blocks","created_at":"2025-12-28T20:51:25.198645434+01:00","created_by":"daemon"}]}
{"id":"dogpile-z2c","title":"AI extraction quality improvements","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T13:02:55.54000007+01:00","updated_at":"2025-12-29T17:28:17.196690131+01:00","closed_at":"2025-12-29T17:28:17.196690131+01:00","close_reason":"All child tasks completed: shelter context injection, is_foster default fix, and description column cleanup."}
{"id":"dogpile-z2c.1","title":"Inject shelter context into AI prompts","description":"Pass shelter name and city to text extraction prompt so AI can infer location_city when not explicitly mentioned. Currently LLM returns null for location_city even though shelter is in Jawor.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T13:03:02.161699495+01:00","updated_at":"2025-12-29T13:34:22.044929892+01:00","closed_at":"2025-12-29T13:34:22.044929892+01:00","close_reason":"Added shelter context to text extraction prompt with SHELTER_NAME and SHELTER_CITY","dependencies":[{"issue_id":"dogpile-z2c.1","depends_on_id":"dogpile-z2c","type":"parent-child","created_at":"2025-12-29T13:03:02.173527954+01:00","created_by":"daemon"}]}
{"id":"dogpile-z2c.2","title":"Fix is_foster to default false instead of null","description":"is_foster is boolean but stored as null when AI doesn't find info. Should default to false since most dogs are in shelter, not foster homes.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T13:03:09.098436445+01:00","updated_at":"2025-12-29T13:34:23.59863922+01:00","closed_at":"2025-12-29T13:34:23.59863922+01:00","close_reason":"is_foster now defaults to 0, location_city defaults to adapter.city","dependencies":[{"issue_id":"dogpile-z2c.2","depends_on_id":"dogpile-z2c","type":"parent-child","created_at":"2025-12-29T13:03:09.108273044+01:00","created_by":"daemon"}]}
{"id":"dogpile-z2c.3","title":"Remove redundant description column","description":"DB has both 'description' and 'generated_bio' columns. description is always empty. Remove it or clarify purpose - generated_bio is the AI-written description.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-29T13:03:21.569653298+01:00","updated_at":"2025-12-29T17:27:56.63471967+01:00","closed_at":"2025-12-29T17:27:56.63471967+01:00","close_reason":"Removed redundant description column. Now only using generatedBio for AI-generated text, rawDescription for original scraped content.","dependencies":[{"issue_id":"dogpile-z2c.3","depends_on_id":"dogpile-z2c","type":"parent-child","created_at":"2025-12-29T13:03:21.581317193+01:00","created_by":"daemon"}]}
{"id":"dogpile-z8u","title":"[Kujawsko-Pomorskie] Shelter Scrapers","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T13:21:33.825072085+01:00","updated_at":"2025-12-30T13:21:33.825072085+01:00","dependencies":[{"issue_id":"dogpile-z8u","depends_on_id":"dogpile-fhe","type":"related","created_at":"2025-12-30T13:21:33.840132968+01:00","created_by":"daemon"}]}
{"id":"dogpile-z8u.1","title":"Scraper: Schronisko w Bydgoszczy","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.856544569+01:00","updated_at":"2025-12-30T13:21:33.856544569+01:00","dependencies":[{"issue_id":"dogpile-z8u.1","depends_on_id":"dogpile-z8u","type":"parent-child","created_at":"2025-12-30T13:21:33.856813402+01:00","created_by":"daemon"}]}
{"id":"dogpile-z8u.2","title":"Scraper: Schronisko w Toruniu","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.925675993+01:00","updated_at":"2025-12-30T13:21:33.925675993+01:00","dependencies":[{"issue_id":"dogpile-z8u.2","depends_on_id":"dogpile-z8u","type":"parent-child","created_at":"2025-12-30T13:21:33.926001243+01:00","created_by":"daemon"}]}
{"id":"dogpile-z8u.3","title":"Scraper: Fundacja Hospicjum dla Kotów Bezdomnych","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:33.996038016+01:00","updated_at":"2025-12-30T13:21:33.996038016+01:00","dependencies":[{"issue_id":"dogpile-z8u.3","depends_on_id":"dogpile-z8u","type":"parent-child","created_at":"2025-12-30T13:21:33.996324953+01:00","created_by":"daemon"}]}
{"id":"dogpile-z8u.4","title":"Scraper: Schronisko we Włocławku","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T13:21:34.065365725+01:00","updated_at":"2025-12-30T13:21:34.065365725+01:00","dependencies":[{"issue_id":"dogpile-z8u.4","depends_on_id":"dogpile-z8u","type":"parent-child","created_at":"2025-12-30T13:21:34.065663192+01:00","created_by":"daemon"}]}
{"id":"dogpile-zv5","title":"Implement TextExtractor service","description":"Create TextExtractor Effect service for extracting structured dog data from shelter text.\n\n## Depends on\n- OpenRouterClient (dogpile-czv)\n- JSON Schemas (dogpile-ogp)\n- AI Config (dogpile-u1d)\n\n## Interface\n```typescript\ninterface TextExtractor {\n  extract: (rawDescription: string) =\u003e Effect\u003cTextExtractionResult, ExtractionError\u003e\n}\n```\n\n## Implementation\n1. Use OpenRouterClient.responses() with MODEL_TEXT_EXTRACTION\n2. System prompt: extraction instructions with examples\n3. User message: the raw shelter description\n4. response_format: { type: 'json_schema', json_schema: TextExtractionSchema }\n5. Parse response with Effect Schema decoder\n6. Map errors appropriately\n\n## Prompt Engineering\n- Handle Polish language text\n- Extract all possible fields, use null for missing\n- Recognize common Polish shelter terminology\n- Handle inconsistent formatting gracefully\n\nLocation: packages/core/src/services/ai/text-extractor.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T20:42:26.005652745+01:00","updated_at":"2025-12-28T21:07:22.951423499+01:00","closed_at":"2025-12-28T21:07:22.951423499+01:00","close_reason":"Implemented TextExtractor with OpenRouter structured output","dependencies":[{"issue_id":"dogpile-zv5","depends_on_id":"dogpile-czv","type":"blocks","created_at":"2025-12-28T20:43:21.87739281+01:00","created_by":"daemon"},{"issue_id":"dogpile-zv5","depends_on_id":"dogpile-u1d","type":"blocks","created_at":"2025-12-28T20:43:21.897090493+01:00","created_by":"daemon"},{"issue_id":"dogpile-zv5","depends_on_id":"dogpile-ogp","type":"blocks","created_at":"2025-12-28T20:43:21.912233902+01:00","created_by":"daemon"},{"issue_id":"dogpile-zv5","depends_on_id":"dogpile-ada","type":"blocks","created_at":"2025-12-28T20:51:25.176184686+01:00","created_by":"daemon"}]}
{"id":"dogpile-zw3","title":"Pipeline concurrency and Effect-TS refactoring","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-29T13:02:24.784177479+01:00","updated_at":"2025-12-29T16:45:52.2600019+01:00","closed_at":"2025-12-29T16:45:52.2600019+01:00","close_reason":"All child tasks completed: concurrency implemented and CLI refactored to idiomatic Effect-TS"}
{"id":"dogpile-zw3.1","title":"Add concurrency parameter for parallel AI processing","description":"Add --concurrency CLI flag (default 10, max 60). Process dogs in parallel batches using Effect.forEach with concurrency option instead of sequential for loop.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T13:02:31.612063613+01:00","updated_at":"2025-12-29T13:34:20.527221321+01:00","closed_at":"2025-12-29T13:34:20.527221321+01:00","close_reason":"Added --concurrency flag and Effect.forEach with bounded concurrency","dependencies":[{"issue_id":"dogpile-zw3.1","depends_on_id":"dogpile-zw3","type":"parent-child","created_at":"2025-12-29T13:02:31.631936178+01:00","created_by":"daemon"}]}
{"id":"dogpile-zw3.2","title":"Refactor CLI to use Effect streams and functional pipelines","description":"Replace imperative for loops with Effect.forEach, Stream, and functional composition. Code should be idiomatic Effect-TS, not imperative TypeScript.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T13:02:38.065704522+01:00","updated_at":"2025-12-29T16:44:25.341704202+01:00","closed_at":"2025-12-29T16:44:25.341704202+01:00","close_reason":"Refactored CLI to use typed argument parser and Effect.forEach for idiomatic Effect-TS. Note: @effect/cli migration blocked by msgpackr ESM compatibility issue with Bun - will retry when upstream fixes the issue.","dependencies":[{"issue_id":"dogpile-zw3.2","depends_on_id":"dogpile-zw3","type":"parent-child","created_at":"2025-12-29T13:02:38.077786122+01:00","created_by":"daemon"}]}
